import{r as e,j as s,C as t,l as n,m as a,n as o,o as i,O as r,V as l,F as c,H as d,k as x,S as m,f as h,u,D as p}from"./three-vendor-BoyHWg1a.js";import{a as j,d as g,B as b,C as f,e as w,P as y}from"./index-D20SIRsj.js";import{aA as N,V as v,s as M,T as C,A as k,m as F,L as S,o as E,J as P,w as I,H as D,d as G,aB as z}from"./ui-vendor-BCOa7pYq.js";import"./core-vendor-Csnc5NqJ.js";const A={spring:{name:"æ˜¥Â·æ’ç§§",emoji:"ğŸŒ¸",baseColor:new n("#7CB342"),waterColor:new n("#4FC3F7"),skyColor:new n("#87CEEB"),fogColor:new n("#E8F5E9"),ambientIntensity:.6,description:"æ˜¥é›¨æ¶¦ç”°ï¼Œæ’ç§§æ—¶èŠ‚"},summer:{name:"å¤Â·é’ç¦¾",emoji:"ğŸŒ¿",baseColor:new n("#388E3C"),waterColor:new n("#29B6F6"),skyColor:new n("#64B5F6"),fogColor:new n("#E3F2FD"),ambientIntensity:.8,description:"è›™å£°ä¸€ç‰‡ï¼Œé’ç¦¾æ‘‡æ›³"},autumn:{name:"ç§‹Â·é‡‘ç©—",emoji:"ğŸŒ¾",baseColor:new n("#F9A825"),waterColor:new n("#4DD0E1"),skyColor:new n("#FFB74D"),fogColor:new n("#FFF8E1"),ambientIntensity:.7,description:"ç¨»æµªé‡‘é»„ï¼Œä¸°æ”¶åœ¨æœ›"},winter:{name:"å†¬Â·ä¼‘è€•",emoji:"â„ï¸",baseColor:new n("#90A4AE"),waterColor:new n("#B0BEC5"),skyColor:new n("#CFD8DC"),fogColor:new n("#ECEFF1"),ambientIntensity:.4,description:"ç”°é‡æ²‰ç¡ï¼Œè“„åŠ¿å¾…æ˜¥"}},B={dawn:{name:"æ™¨æ›¦",hour:6,sunPosition:[100,10,0],intensity:.3,color:"#FF8A65",skyTurbidity:8},morning:{name:"æ¸…æ™¨",hour:8,sunPosition:[80,40,20],intensity:.7,color:"#FFF9C4",skyTurbidity:10},noon:{name:"æ­£åˆ",hour:12,sunPosition:[0,100,0],intensity:1.2,color:"#FFFFFF",skyTurbidity:10},afternoon:{name:"åˆå",hour:15,sunPosition:[-60,60,30],intensity:.9,color:"#FFF59D",skyTurbidity:10},dusk:{name:"é»„æ˜",hour:18,sunPosition:[-100,15,0],intensity:.4,color:"#FF7043",skyTurbidity:8},night:{name:"å¤œå¹•",hour:21,sunPosition:[-100,-30,0],intensity:.05,color:"#1A237E",skyTurbidity:20}},T=[{id:"forest",name:"æ£®æ—",icon:C,color:"#2E7D32",description:"æ¶µå…»æ°´æºï¼Œå‡€åŒ–ç©ºæ°”"},{id:"village",name:"æ‘å¯¨",icon:D,color:"#8D6E63",description:"äººä¸è‡ªç„¶å’Œè°å…±ç”Ÿ"},{id:"terrace",name:"æ¢¯ç”°",icon:G,color:"#689F38",description:"åƒå¹´å†œè€•æ™ºæ…§ç»“æ™¶"},{id:"water",name:"æ°´ç³»",icon:z,color:"#0288D1",description:"ç”Ÿå‘½ä¹‹æºï¼Œå¾ªç¯ä¸æ¯"}],_=[{season:"spring",text:"æ˜¥æ°´åˆç”Ÿæ˜ ç¢§å¤©ï¼Œå±‚å±‚ç»¿æµªå…¥äº‘çƒŸã€‚å“ˆå°¼å„¿å¥³å‹¤è€•ä½œï¼Œåƒå¹´æ¢¯ç”°ç»­æ–°ç¯‡ã€‚"},{season:"summer",text:"å¤æ—¥è›™é¸£æ»¡ç”°é—´ï¼Œé’ç¦¾å¦‚æµªç¢§è¿å¤©ã€‚äº‘é›¾ç¼­ç»•ä»™å¢ƒé‡Œï¼Œäººé—´çƒŸç«èƒœç¥ä»™ã€‚"},{season:"autumn",text:"é‡‘ç§‹åæœˆç¨»èŠ±é¦™ï¼Œå±‚å æ¢¯ç”°æŠ«é‡‘è£…ã€‚å“ˆå°¼é•¿è¡—å®´å¼€å¸­ï¼Œä¸°æ”¶å–œæ‚¦æ»¡å±±ä¹¡ã€‚"},{season:"winter",text:"å†¬æ—¥æš–é˜³ç…§æ¢¯ç”°ï¼Œé“¶éœœç‚¹ç‚¹æ˜ è“å¤©ã€‚ä¸‡ç‰©ä¼‘å…»è“„åŠ›æ—¶ï¼Œæ¥å¹´åˆæ˜¯ä¸°æ”¶å¹´ã€‚"}];function O({position:e,scale:t=1}){return s.jsxs("group",{position:e,scale:t,children:[s.jsxs("mesh",{position:[0,.4,0],castShadow:!0,children:[s.jsx("cylinderGeometry",{args:[.08,.12,.8,8]}),s.jsx("meshStandardMaterial",{color:"#5D4037",roughness:.9})]}),s.jsxs("mesh",{position:[0,1,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[.5,.8,8]}),s.jsx("meshStandardMaterial",{color:"#2E7D32",roughness:.8})]}),s.jsxs("mesh",{position:[0,1.4,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[.4,.6,8]}),s.jsx("meshStandardMaterial",{color:"#388E3C",roughness:.8})]}),s.jsxs("mesh",{position:[0,1.7,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[.25,.4,8]}),s.jsx("meshStandardMaterial",{color:"#43A047",roughness:.8})]})]})}function $({position:t,count:n=30}){const a=e.useMemo(()=>{const e=[];for(let s=0;s<n;s++){const t=s/n*Math.PI*2+.5*Math.random(),a=2+4*Math.random(),o=Math.cos(t)*a,i=Math.sin(t)*a,r=.6+.6*Math.random();e.push({x:o,z:i,scale:r,key:s})}return e},[n]);return s.jsx("group",{position:t,children:a.map(e=>s.jsx(O,{position:[e.x,0,e.z],scale:e.scale},e.key))})}function R({position:e,scale:t=1}){return s.jsxs("group",{position:e,scale:1.8*t,children:[s.jsxs("mesh",{position:[0,.15,0],castShadow:!0,receiveShadow:!0,children:[s.jsx("boxGeometry",{args:[1.6,.3,1.2]}),s.jsx("meshStandardMaterial",{color:"#757575",roughness:.95})]}),s.jsxs("mesh",{position:[0,.8,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.4,1.2,1]}),s.jsx("meshStandardMaterial",{color:"#6D4C41",roughness:.85})]}),s.jsxs("mesh",{position:[0,.4,.51],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.5,.1,.05]}),s.jsx("meshStandardMaterial",{color:"#5D4037"})]}),s.jsxs("mesh",{position:[0,1.7,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[1.3,1,8]}),s.jsx("meshStandardMaterial",{color:"#4E342E",roughness:.9})]}),s.jsxs("mesh",{position:[0,2.2,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[.8,.6,8]}),s.jsx("meshStandardMaterial",{color:"#3E2723",roughness:.9})]}),s.jsxs("mesh",{position:[0,2.6,0],castShadow:!0,children:[s.jsx("coneGeometry",{args:[.2,.4,6]}),s.jsx("meshStandardMaterial",{color:"#212121",roughness:.9})]}),s.jsxs("mesh",{position:[0,.5,.51],children:[s.jsx("boxGeometry",{args:[.4,.8,.05]}),s.jsx("meshStandardMaterial",{color:"#3E2723"})]}),s.jsxs("mesh",{position:[-.45,.8,.51],children:[s.jsx("boxGeometry",{args:[.25,.3,.05]}),s.jsx("meshStandardMaterial",{color:"#FFECB3",emissive:"#FFE082",emissiveIntensity:.5})]}),s.jsxs("mesh",{position:[.45,.8,.51],children:[s.jsx("boxGeometry",{args:[.25,.3,.05]}),s.jsx("meshStandardMaterial",{color:"#FFECB3",emissive:"#FFE082",emissiveIntensity:.5})]})]})}function L({position:t}){const n=e.useMemo(()=>[{x:0,z:0,scale:1.2,rotation:0},{x:3,z:.5,scale:1.1,rotation:.3},{x:-2.5,z:1.5,scale:1,rotation:-.2},{x:1.5,z:2.5,scale:.95,rotation:.5},{x:-1.5,z:-2,scale:1.1,rotation:-.4},{x:4,z:-1.5,scale:.9,rotation:.1},{x:-4,z:0,scale:1,rotation:.6},{x:2,z:-2.5,scale:.85,rotation:-.3}],[]);return s.jsx("group",{position:t,children:n.map((e,t)=>s.jsx("group",{rotation:[0,e.rotation,0],children:s.jsx(R,{position:[e.x,0,e.z],scale:e.scale})},t))})}function W({points:t,width:n=.3}){const a=e.useMemo(()=>new h(t),[t]);return s.jsxs("mesh",{children:[s.jsx("tubeGeometry",{args:[a,64,n,8,!1]}),s.jsx("meshStandardMaterial",{color:"#4FC3F7",transparent:!0,opacity:.7,roughness:.1,metalness:.3})]})}function V({y:t,radius:n,color:a,waterColor:o,hasWater:i=!0}){const r=e.useMemo(()=>{const e=new m;for(let s=0;s<=64;s++){const t=s/64*Math.PI*2,a=n*(1+.18*Math.sin(3*t)+.12*Math.cos(5*t)+.05*Math.sin(7*t)),o=Math.cos(t)*a,i=Math.sin(t)*a;0===s?e.moveTo(o,i):e.lineTo(o,i)}return e},[n]),l=e.useMemo(()=>{const e=new m,s=.92*n;for(let t=0;t<=64;t++){const n=t/64*Math.PI*2,a=s*(1+.15*Math.sin(3*n)+.1*Math.cos(5*n)),o=Math.cos(n)*a,i=Math.sin(n)*a;0===t?e.moveTo(o,i):e.lineTo(o,i)}return e},[n]);return s.jsxs("group",{position:[0,t,0],children:[s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[s.jsx("extrudeGeometry",{args:[r,{depth:.2,bevelEnabled:!1}]}),s.jsx("meshStandardMaterial",{color:a,roughness:.8})]}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.18,0],children:[s.jsx("shapeGeometry",{args:[l]}),s.jsx("meshStandardMaterial",{color:o,transparent:!0,opacity:.7,roughness:.05,metalness:.6,envMapIntensity:1.5})]}),s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.19,0],children:[s.jsx("shapeGeometry",{args:[l]}),s.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.15})]})]})]})}function H({seed:t,season:n,plantedRice:a,onPlant:o}){const i=A[n],r=e.useMemo(()=>{const e=[];for(let s=0;s<12;s++){const a=.8*s,o=18-1.2*s,i=.5*Math.sin(t+100*s);e.push({y:a,radius:Math.max(2,o+i),hasWater:"winter"!==n&&s<10})}return e},[t,n]),c=e.useMemo(()=>[new l(0,10,-2),new l(-2,8,-1),new l(-4,6,1),new l(-6,4,3),new l(-8,2,5),new l(-10,0,8)],[]),d=e.useCallback(e=>{e.stopPropagation&&e.stopPropagation();const s=e.point;s&&o(new l(s.x,s.y+.3,s.z))},[o]),x=e.useMemo(()=>{const e="spring"===n?120:"summer"===n?130:"autumn"===n?45:200;return r.map((s,t)=>`hsl(${e}, ${"winter"===n?10:50}%, ${35+2*t}%)`)},[n,r]);return s.jsxs("group",{onClick:d,children:[s.jsxs("mesh",{position:[0,-.5,0],receiveShadow:!0,children:[s.jsx("cylinderGeometry",{args:[20,22,1,64]}),s.jsx("meshStandardMaterial",{color:"#5D4037",roughness:.95})]}),r.map((e,t)=>s.jsx(V,{y:e.y,radius:e.radius,color:x[t],waterColor:i.waterColor.getStyle(),hasWater:e.hasWater},t)),s.jsx($,{position:[0,9.5,0],count:35}),s.jsx(L,{position:[-8,4,6]}),s.jsx(L,{position:[10,3,2]}),s.jsx(W,{points:c,width:.2}),s.jsx(W,{points:[new l(2,10,0),new l(4,7,2),new l(7,4,4),new l(10,1,7)],width:.15}),a.map(e=>s.jsx(J,{rice:e,season:n},e.id))]})}function J({rice:t,season:n}){const a=e.useRef(null),[o,i]=e.useState(0),[r,l]=e.useState(1);e.useEffect(()=>{const e=setTimeout(()=>i(1),100);return()=>clearTimeout(e)},[]),e.useEffect(()=>{const e=setInterval(()=>{l(e=>e>=3?1:e+.05)},50);return()=>clearInterval(e)},[]),u(e=>{a.current&&(a.current.rotation.z=.15*Math.sin(2*e.clock.elapsedTime+t.position.x),a.current.rotation.x=.05*Math.cos(1.5*e.clock.elapsedTime+t.position.z))});const c=.8+1.2*t.growth,d="autumn"===n?"#F9A825":"#4CAF50",x="autumn"===n?"#FFD54F":"#81C784";return s.jsxs("group",{ref:a,position:t.position,scale:o,children:[s.jsx("pointLight",{position:[0,.3,0],color:x,intensity:.5,distance:2}),[0,.1,-.1,.05,-.05].map((e,t)=>s.jsxs("mesh",{position:[e,c/2,.5*e],rotation:[0,.5*t,0],children:[s.jsx("cylinderGeometry",{args:[.03,.05,c*(.8+.05*t),8]}),s.jsx("meshStandardMaterial",{color:d,emissive:d,emissiveIntensity:.2})]},t)),[.3,-.3,.5,-.5].map((e,t)=>s.jsxs("mesh",{position:[0,.6*c,0],rotation:[.3,e,.2*(t%2?1:-1)],children:[s.jsx("boxGeometry",{args:[.02,.4,.15]}),s.jsx("meshStandardMaterial",{color:d,side:p})]},`leaf-${t}`)),t.growth>.3&&s.jsxs("group",{position:[0,c,0],rotation:[.3,0,0],children:[s.jsxs("mesh",{children:[s.jsx("cylinderGeometry",{args:[.08,.02,.4,8]}),s.jsx("meshStandardMaterial",{color:"autumn"===n?"#FFD54F":"#81C784",emissive:"autumn"===n?"#FFA000":"#66BB6A",emissiveIntensity:.3})]}),[...Array(8)].map((e,t)=>s.jsxs("mesh",{position:[.06*Math.cos(t*Math.PI/4),-.1-.03*t,.06*Math.sin(t*Math.PI/4)],children:[s.jsx("sphereGeometry",{args:[.04,6,6]}),s.jsx("meshStandardMaterial",{color:"autumn"===n?"#FFC107":"#A5D6A7"})]},t))]}),s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.02,0],scale:r,children:[s.jsx("ringGeometry",{args:[.2,.5,32]}),s.jsx("meshBasicMaterial",{color:"#4FC3F7",transparent:!0,opacity:.6*(1-(r-1)/2)})]}),s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],scale:.7*r+.5,children:[s.jsx("ringGeometry",{args:[.3,.6,32]}),s.jsx("meshBasicMaterial",{color:"#81D4FA",transparent:!0,opacity:.4*(1-(r-1)/2)})]})]})}function Z({activeElement:e,onElementClick:t}){return s.jsxs("group",{position:[0,8,0],children:[T.map((n,a)=>{const o=a/4*Math.PI*2-Math.PI/2,i=5*Math.cos(o),r=5*Math.sin(o),l=e===n.id;return s.jsx(c,{speed:2,rotationIntensity:.5,floatIntensity:.5,children:s.jsxs("group",{position:[i,0,r],onClick:()=>t(n.id),children:[s.jsxs("mesh",{scale:l?1.3:1,children:[s.jsx("sphereGeometry",{args:[.8,32,32]}),s.jsx("meshStandardMaterial",{color:n.color,emissive:n.color,emissiveIntensity:l?.5:.2})]}),s.jsx(d,{center:!0,position:[0,1.5,0],children:s.jsx("div",{className:"px-3 py-1 rounded-full text-white text-sm whitespace-nowrap transition-all "+(l?"bg-eco-600 scale-110":"bg-black/50"),children:n.name})})]})},n.id)}),s.jsxs("mesh",{children:[s.jsx("torusGeometry",{args:[5,.05,16,100]}),s.jsx("meshBasicMaterial",{color:"#22c55e",transparent:!0,opacity:.5})]})]})}function q({season:e,intensity:t}){const n=Math.floor(500*t);return"winter"===e?s.jsx(x,{count:n,scale:40,size:3,speed:.5,color:"#ffffff"}):"spring"===e?s.jsx(x,{count:n,scale:40,size:2,speed:.3,color:"#FFB7C5"}):null}function K({config:e,onPlant:t,activeElement:n,onElementClick:l,showFourElements:c}){const d=A[e.season],x=B[e.timeOfDay];return s.jsxs(s.Fragment,{children:[s.jsx(a,{distance:45e4,sunPosition:x.sunPosition,inclination:.5,azimuth:.25}),"night"===e.timeOfDay&&s.jsx(o,{radius:100,depth:50,count:5e3,factor:4,fade:!0}),"night"!==e.timeOfDay&&s.jsx(i,{position:[0,15,-10],speed:.2,opacity:.5}),s.jsx("ambientLight",{intensity:d.ambientIntensity*x.intensity}),s.jsx("directionalLight",{position:x.sunPosition,intensity:x.intensity,color:x.color,castShadow:!0}),s.jsx("fog",{attach:"fog",args:[d.fogColor.getStyle(),20,80]}),s.jsx(H,{seed:e.seed,season:e.season,plantedRice:e.plantedRice,onPlant:t}),c&&s.jsx(Z,{activeElement:n,onElementClick:l}),s.jsx(q,{season:e.season,intensity:e.weatherIntensity}),s.jsx(r,{enableZoom:!0,enablePan:!0,minDistance:5,maxDistance:50,minPolarAngle:.2,maxPolarAngle:Math.PI/2.2,target:[0,2,0]})]})}function Q({current:e,onChange:t}){return s.jsx("div",{className:"flex gap-2",children:["spring","summer","autumn","winter"].map(n=>{const a=A[n],o=e===n;return s.jsxs("button",{onClick:()=>t(n),className:"flex flex-col items-center p-3 rounded-xl transition-all "+(o?"bg-eco-500 text-white scale-105 shadow-lg":"bg-white/80 text-ink-600 hover:bg-eco-50"),children:[s.jsx("span",{className:"text-2xl mb-1",children:a.emoji}),s.jsx("span",{className:"text-xs font-medium",children:a.name})]},n)})})}function U({current:e,onChange:t,isPlaying:n,onTogglePlay:a}){const o=["dawn","morning","noon","afternoon","dusk","night"],i=o.indexOf(e);return s.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm font-medium text-ink-700",children:"æ—¶é—´è½´"}),s.jsx("button",{onClick:a,className:"p-2 rounded-full transition-colors "+(n?"bg-eco-500 text-white":"bg-ink-100 text-ink-600"),children:n?s.jsx(P,{className:"w-4 h-4"}):s.jsx(I,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"h-2 bg-gradient-to-r from-orange-300 via-yellow-300 via-blue-300 to-indigo-900 rounded-full"}),s.jsx("input",{type:"range",min:0,max:o.length-1,value:i,onChange:e=>t(o[parseInt(e.target.value)]),className:"absolute inset-0 w-full opacity-0 cursor-pointer"}),s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-eco-500",style:{left:`calc(${i/(o.length-1)*100}% - 8px)`}})]}),s.jsx("div",{className:"flex justify-between mt-2 text-xs text-ink-500",children:o.map(e=>s.jsx("span",{children:B[e].name},e))})]})}function X({count:e,season:t}){const n=5*e;return s.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl p-4",children:[s.jsxs("h3",{className:"text-sm font-bold text-ink-700 mb-3 flex items-center gap-2",children:[s.jsx(S,{className:"w-4 h-4 text-eco-500"}),"æˆ‘çš„ç”Ÿæ€è´¡çŒ®"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-eco-50 rounded-xl p-3 text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-eco-600",children:e}),s.jsx("p",{className:"text-xs text-eco-700",children:"æ£µç¨»è‹—"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[n,"g"]}),s.jsx("p",{className:"text-xs text-blue-700",children:"å›ºç¢³é‡"})]})]}),s.jsx("p",{className:"text-xs text-ink-500 mt-3 text-center",children:"ç‚¹å‡»æ¢¯ç”°ç§ä¸‹æ‚¨çš„ç”Ÿæ€ç¨»è‹— ğŸŒ±"})]})}function Y({activeElement:e,onClose:t}){const n=T.find(s=>s.id===e);if(!n)return null;const a=n.icon;return s.jsxs(F.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:50},className:"absolute right-4 top-1/2 -translate-y-1/2 w-72 bg-white/95 backdrop-blur rounded-2xl p-5 shadow-xl z-20",children:[s.jsx("button",{onClick:t,className:"absolute top-3 right-3 p-1 hover:bg-ink-100 rounded-full",children:"âœ•"}),s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{backgroundColor:n.color},children:s.jsx(a,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-ink-800",children:n.name}),s.jsx("p",{className:"text-xs text-ink-500",children:"å››ç´ åŒæ„"})]})]}),s.jsx("p",{className:"text-sm text-ink-600 leading-relaxed mb-4",children:n.description}),s.jsx("div",{className:"bg-eco-50 rounded-xl p-3",children:s.jsx("p",{className:"text-xs text-eco-700",children:'ğŸŒ¿ å“ˆå°¼æ¢¯ç”°çš„"å››ç´ åŒæ„"æ˜¯æŒ‡æ£®æ—ã€æ‘å¯¨ã€æ¢¯ç”°ã€æ°´ç³»å››ä¸ªè¦ç´ ç›¸äº’ä¾å­˜ã€å¾ªç¯å…±ç”Ÿçš„ç”Ÿæ€ç³»ç»Ÿï¼Œè¢«èª‰ä¸ºäººä¸è‡ªç„¶å’Œè°å…±ç”Ÿçš„å…¸èŒƒã€‚'})})]})}function ee({season:e}){const t=_.find(s=>s.season===e);return s.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur rounded-2xl p-4 max-w-sm",children:[s.jsx("p",{className:"text-sm text-ink-700 leading-relaxed font-serif",children:null==t?void 0:t.text}),s.jsx("p",{className:"text-xs text-ink-400 mt-2 text-right",children:"â€” AIç”Ÿæˆ"})]})}function se({config:e,onClose:t,onGeneratePolaroid:n}){const a=A[e.season],o=f.hani_terrace.baseSaving+5*e.plantedRice.length;return s.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black/60 z-50 p-4",children:s.jsxs(F.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-white rounded-3xl p-6 max-w-md w-full",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(F.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:.5,repeat:2},className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-eco-400 to-eco-600 rounded-2xl flex items-center justify-center",children:s.jsx(G,{className:"w-10 h-10 text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-ink-800 mb-2",children:"ğŸ‰ ä½“éªŒå®Œæˆï¼"}),s.jsx("p",{className:"text-ink-500",children:"æ‚¨å·²å®Œæˆå“ˆå°¼æ¢¯ç”°æ²‰æµ¸å¼ä½“éªŒ"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[s.jsxs("div",{className:"bg-eco-50 rounded-xl p-3 text-center",children:[s.jsx("p",{className:"text-lg font-bold text-eco-600",children:e.plantedRice.length}),s.jsx("p",{className:"text-xs text-eco-700",children:"ç§æ¤ç¨»è‹—"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 text-center",children:[s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[o,"g"]}),s.jsx("p",{className:"text-xs text-blue-700",children:"ç¢³å‡æ’"})]}),s.jsxs("div",{className:"bg-amber-50 rounded-xl p-3 text-center",children:[s.jsx("p",{className:"text-lg font-bold text-amber-600",children:a.emoji}),s.jsx("p",{className:"text-xs text-amber-700",children:a.name})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-eco-50 to-blue-50 rounded-xl p-4 mb-6",children:[s.jsx("p",{className:"text-sm font-bold text-ink-700 mb-2",children:"ğŸ† è·å¾—æˆå°±"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-400 to-amber-600 rounded-xl flex items-center justify-center",children:s.jsx(S,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-ink-800",children:"æ¢¯ç”°å®ˆæŠ¤è€…"}),s.jsx("p",{className:"text-xs text-ink-500",children:"å®Œæˆå“ˆå°¼æ¢¯ç”°ç”Ÿæ€ä½“éªŒ"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(b,{className:"w-full bg-gradient-to-r from-eco-500 to-eco-600",onClick:n,children:[s.jsx(E,{className:"w-4 h-4 mr-2"}),"ç”Ÿæˆä¸“å±æ‹ç«‹å¾—"]}),s.jsx(b,{variant:"outline",className:"w-full",onClick:t,children:"ç»§ç»­æ¢ç´¢"})]})]})})}function te(){const[n]=e.useState(()=>Math.floor(1e5*Math.random())),[a,o]=e.useState("spring"),[i,r]=e.useState("morning"),[l,c]=e.useState([]),[d,x]=e.useState(!1),[m,h]=e.useState(!1),[u,p]=e.useState(null),[P,I]=e.useState(!1),[D,G]=e.useState(!0),[z,B]=e.useState(!1),{addCarbonSaving:T}=j(),{unlockScene:_}=g(),O={seed:n,season:a,timeOfDay:i,plantedRice:l,weatherIntensity:"winter"===a?.5:"spring"===a?.3:0};e.useEffect(()=>{if(!d)return;const e=["dawn","morning","noon","afternoon","dusk","night"],s=setInterval(()=>{r(s=>{const t=(e.indexOf(s)+1)%e.length;return e[t]})},3e3);return()=>clearInterval(s)},[d]);const $=e.useCallback(e=>{const s={id:`rice-${Date.now()}-${Math.random()}`,position:e,plantedAt:Date.now(),growth:.5*Math.random()+.5};c(e=>[...e,s]),(l.length+1)%10==0&&(B(!0),setTimeout(()=>B(!1),5e3))},[l.length]);return s.jsxs("div",{className:"relative w-full h-screen bg-ink-900",children:[s.jsx(t,{shadows:!0,camera:{position:[0,15,25],fov:60},gl:{antialias:!0,alpha:!0},children:s.jsx(K,{config:O,onPlant:$,activeElement:u,onElementClick:p,showFourElements:m})}),s.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/60 to-transparent z-10",children:s.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[s.jsxs("div",{className:"text-white",children:[s.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[A[a].emoji," å“ˆå°¼æ¢¯ç”°"]}),s.jsxs("p",{className:"text-sm text-white/70",children:["ä¸–ç•Œæ–‡åŒ–é—äº§ Â· ",A[a].description]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>G(!D),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:D?s.jsx(N,{className:"w-5 h-5"}):s.jsx(v,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>{c([]),o("spring"),r("morning"),h(!1),p(null)},className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:s.jsx(M,{className:"w-5 h-5"})})]})]})}),s.jsxs("div",{className:"absolute left-4 top-24 space-y-4 z-10 w-64",children:[s.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl p-4",children:[s.jsx("h3",{className:"text-sm font-bold text-ink-700 mb-3",children:"å››å­£è½®å›"}),s.jsx(Q,{current:a,onChange:o})]}),s.jsx(U,{current:i,onChange:r,isPlaying:d,onTogglePlay:()=>x(!d)}),s.jsx(X,{count:l.length,season:a}),s.jsxs("button",{onClick:()=>h(!m),className:"w-full flex items-center justify-center gap-2 p-3 rounded-xl transition-all "+(m?"bg-eco-500 text-white":"bg-white/90 text-ink-700 hover:bg-eco-50"),children:[s.jsx(C,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"å››ç´ åŒæ„"})]})]}),s.jsx(k,{children:u&&s.jsx(Y,{activeElement:u,onClose:()=>p(null)})}),s.jsx(k,{children:z&&s.jsx(F.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"absolute bottom-24 left-1/2 -translate-x-1/2 z-20",children:s.jsx(ee,{season:a})})}),s.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",children:s.jsxs("div",{className:"flex items-center gap-4 px-6 py-3 bg-white/90 backdrop-blur rounded-full",children:[s.jsxs("div",{className:"flex items-center gap-2 text-ink-600",children:[s.jsx(S,{className:"w-4 h-4 text-eco-500"}),s.jsx("span",{className:"text-sm",children:"ç‚¹å‡»æ¢¯ç”°ç§æ¤ç¨»è‹—"})]}),s.jsx("div",{className:"w-px h-6 bg-ink-200"}),s.jsxs(b,{onClick:()=>{const e=f.hani_terrace.baseSaving+5*l.length;T({type:"cloud_tour",carbonSaved:e,description:`å“ˆå°¼æ¢¯ç”°ä½“éªŒ - ç§æ¤${l.length}æ£µç¨»è‹—`,experienceId:"hani_terrace"}),w("å®Œæˆå“ˆå°¼æ¢¯ç”°V2ä½“éªŒ",y.experience_complete),_("hani_terrace"),I(!0)},className:"bg-gradient-to-r from-eco-500 to-eco-600",disabled:l.length<3,children:[s.jsx(E,{className:"w-4 h-4 mr-2"}),"å®Œæˆä½“éªŒ"]})]})}),s.jsx(k,{children:P&&s.jsx(se,{config:O,onClose:()=>I(!1),onGeneratePolaroid:()=>{const e={seed:n,season:a,timeOfDay:i,plantedCount:l.length,carbonSaved:f.hani_terrace.baseSaving+5*l.length};localStorage.setItem("hani_terrace_polaroid_data",JSON.stringify(e)),window.location.hash="/experience/ai-polaroid?scene=hani_terrace"}})})]})}export{te as default};
