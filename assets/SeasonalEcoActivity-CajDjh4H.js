import{r as e,j as s}from"./three-vendor-BoyHWg1a.js";import{C as t}from"./Card-A_2Ty7OA.js";import{B as i}from"./Badge-DTmqmyMd.js";import{u as a,B as n}from"./index-DkRoqGlp.js";import{u as r}from"./ecoAchievementStore-30xRUVWQ.js";import{L as c}from"./core-vendor-Csnc5NqJ.js";import{au as l,m as d,aO as o,aP as m,aI as h,L as x,a7 as g,r as p,A as j,X as b,T as u,Z as N,a6 as f,E as w}from"./ui-vendor-BCOa7pYq.js";const v=[{id:"lichun",name:"立春",englishName:"Start of Spring",date:"02-04",season:"spring",description:"春季开始，万物复苏",ecoTheme:"播种希望",heritage:"藤编工艺",heritageLink:"/experience/bamboo-weaving",activities:["学习春季播种知识","体验藤编春篮制作","发布春季环保承诺"],rewards:{points:100,badge:"立春守护者"}},{id:"yushui",name:"雨水",englishName:"Rain Water",date:"02-19",season:"spring",description:"降雨开始，雨量渐增",ecoTheme:"水循环智慧",heritage:"哈尼梯田",heritageLink:"/experience/hani-terrace",activities:["探索梯田水循环系统","学习雨水收集利用","参与水资源保护问答"],rewards:{points:120,badge:"雨水使者"}},{id:"jingzhe",name:"惊蛰",englishName:"Awakening of Insects",date:"03-06",season:"spring",description:"春雷惊醒蛰伏的昆虫",ecoTheme:"生物多样性",heritage:"茶道生态",heritageLink:"/experience/tea-ceremony",activities:["了解茶园生态系统","学习自然害虫控制","探索生物多样性"],rewards:{points:100,badge:"惊蛰探索者"}},{id:"chunfen",name:"春分",englishName:"Spring Equinox",date:"03-21",season:"spring",description:"昼夜平分，春季过半",ecoTheme:"平衡之道",heritage:"剪纸艺术",heritageLink:"/experience/paper-cutting",activities:["创作春分主题剪纸","学习生态平衡知识","分享春分环保心得"],rewards:{points:150,badge:"春分守护者",nft:!0}},{id:"qingming",name:"清明",englishName:"Pure Brightness",date:"04-05",season:"spring",description:"天气清澈明朗",ecoTheme:"绿色祭扫",heritage:"凤翔泥塑",heritageLink:"/experience/fengxiang-clay",activities:["体验天然材料泥塑","学习绿色祭扫方式","参与植树活动"],rewards:{points:100,badge:"清明使者"}},{id:"guyu",name:"谷雨",englishName:"Grain Rain",date:"04-20",season:"spring",description:"雨生百谷，春季最后一个节气",ecoTheme:"有机种植",heritage:"茶道生态",heritageLink:"/experience/tea-ceremony",activities:["学习有机茶种植","了解谷雨茶文化","参与茶园碳汇计算"],rewards:{points:120,badge:"谷雨播种者"}},{id:"lixia",name:"立夏",englishName:"Start of Summer",date:"05-06",season:"summer",description:"夏季开始，万物繁茂",ecoTheme:"节能降温",heritage:"藤编工艺",heritageLink:"/experience/bamboo-weaving",activities:["体验竹编扇子制作","学习自然降温方法","参与节能挑战"],rewards:{points:100,badge:"立夏守护者"}},{id:"xiaozhi",name:"夏至",englishName:"Summer Solstice",date:"06-21",season:"summer",description:"一年中白昼最长的一天",ecoTheme:"太阳能利用",heritage:"蜡染工艺",heritageLink:"/experience/batik",activities:["体验天然染料蜡染","学习太阳能知识","参与夏至环保活动"],rewards:{points:150,badge:"夏至先锋",nft:!0}},{id:"liqiu",name:"立秋",englishName:"Start of Autumn",date:"08-08",season:"autumn",description:"秋季开始，暑去凉来",ecoTheme:"丰收感恩",heritage:"哈尼梯田",heritageLink:"/experience/hani-terrace",activities:["体验梯田丰收场景","学习粮食节约知识","参与感恩分享"],rewards:{points:100,badge:"立秋守护者"}},{id:"qiufen",name:"秋分",englishName:"Autumn Equinox",date:"09-23",season:"autumn",description:"昼夜平分，秋季过半",ecoTheme:"循环经济",heritage:"皮影戏",heritageLink:"/experience/shadow-puppet",activities:["体验皮影戏制作","学习循环经济理念","参与物品交换活动"],rewards:{points:150,badge:"秋分守护者",nft:!0}},{id:"lidong",name:"立冬",englishName:"Start of Winter",date:"11-08",season:"winter",description:"冬季开始，万物收藏",ecoTheme:"节能保暖",heritage:"剪纸艺术",heritageLink:"/experience/paper-cutting",activities:["创作冬季主题剪纸","学习节能保暖方法","参与冬季环保挑战"],rewards:{points:100,badge:"立冬守护者"}},{id:"dongzhi",name:"冬至",englishName:"Winter Solstice",date:"12-22",season:"winter",description:"一年中白昼最短的一天",ecoTheme:"团圆低碳",heritage:"凤翔泥塑",heritageLink:"/experience/fengxiang-clay",activities:["体验冬至泥塑制作","学习低碳过节方式","参与冬至环保承诺"],rewards:{points:150,badge:"冬至先锋",nft:!0}}],k={spring:{name:"春",icon:x,color:"text-eco-600 bg-eco-100",gradient:"from-eco-400 to-bamboo-500"},summer:{name:"夏",icon:h,color:"text-amber-600 bg-amber-100",gradient:"from-amber-400 to-orange-500"},autumn:{name:"秋",icon:m,color:"text-orange-600 bg-orange-100",gradient:"from-orange-400 to-red-500"},winter:{name:"冬",icon:o,color:"text-blue-600 bg-blue-100",gradient:"from-blue-400 to-indigo-500"}};function y({className:o=""}){const[m,h]=e.useState(null),[y,S]=e.useState(new Set),[T,L]=e.useState(!1),{addPoints:C}=a(),{recordSeasonalActivity:A}=r(),D=e.useMemo(()=>function(){const e=new Date,s=e.getMonth()+1,t=e.getDate();s.toString().padStart(2,"0"),t.toString().padStart(2,"0");let i=null,a=1/0;for(const n of v){const[s,t]=n.date.split("-").map(Number),r=new Date(e.getFullYear(),s-1,t),c=Math.abs(e.getTime()-r.getTime());c<a&&r<=e&&(a=c,i=n)}return i}(),[]),M=e.useMemo(()=>function(){const e=new Date;for(const s of v){const[t,i]=s.date.split("-").map(Number);if(new Date(e.getFullYear(),t-1,i)>e)return s}return v[0]}(),[]),$=e.useMemo(()=>{if(!M)return 0;const e=new Date,[s,t]=M.date.split("-").map(Number),i=new Date(e.getFullYear(),s-1,t);return i<e&&i.setFullYear(i.getFullYear()+1),Math.ceil((i.getTime()-e.getTime())/864e5)},[M]),z=e.useMemo(()=>{const e={spring:[],summer:[],autumn:[],winter:[]};return v.forEach(s=>{e[s.season].push(s)}),e},[]);return s.jsxs("div",{className:`${o}`,children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-ink-900",children:"二十四节气活动"}),s.jsx("p",{className:"text-ink-500",children:"跟随自然节律，体验传统生态智慧"})]}),s.jsxs(i,{variant:"eco",className:"flex items-center gap-1",children:[s.jsx(l,{className:"w-4 h-4"}),"已参与 ",y.size," 个节气"]})]})}),D&&s.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:s.jsxs(t,{className:`p-6 bg-gradient-to-br ${k[D.season].gradient} text-white overflow-hidden relative`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 opacity-20",children:(()=>{const e=k[D.season].icon;return s.jsx(e,{className:"w-full h-full"})})()}),s.jsx(i,{className:"bg-white/20 text-white border-white/30 mb-4",children:"当前节气"}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-3xl font-bold mb-1",children:D.name}),s.jsx("p",{className:"text-white/80 text-sm mb-4",children:D.englishName}),s.jsx("p",{className:"text-white/90 mb-4",children:D.description}),s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(x,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:D.ecoTheme})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(g,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-sm",children:["+",D.rewards.points," 积分"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(n,{className:"bg-white text-ink-900 hover:bg-white/90",onClick:()=>h(D),children:["参与活动",s.jsx(p,{className:"w-4 h-4 ml-1"})]}),s.jsx(n,{variant:"outline",className:"border-white/30 text-white hover:bg-white/10",asChild:!0,children:s.jsxs(c,{to:D.heritageLink,children:["体验",D.heritage]})})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"text-5xl font-bold opacity-90",children:k[D.season].name})})]})]})}),M&&s.jsx(t,{className:"p-4 mb-8 bg-gradient-to-r from-eco-50 to-bamboo-50 border-eco-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-xl ${k[M.season].color} flex items-center justify-center`,children:(()=>{const e=k[M.season].icon;return s.jsx(e,{className:"w-6 h-6"})})()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-ink-500",children:"下一个节气"}),s.jsxs("div",{className:"font-bold text-ink-900",children:[M.name," · ",M.ecoTheme]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-eco-600",children:$}),s.jsx("div",{className:"text-sm text-ink-500",children:"天后开始"})]})]})}),s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-bold text-ink-900",children:"节气日历"}),s.jsx(n,{variant:"outline",size:"sm",onClick:()=>L(!T),children:T?"收起":"查看全部"})]}),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(z).map(([e,a])=>{const n=k[e],r=T?a:a.slice(0,2);return s.jsxs(t,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:`w-8 h-8 rounded-lg ${n.color} flex items-center justify-center`,children:s.jsx(n.icon,{className:"w-4 h-4"})}),s.jsxs("span",{className:"font-bold text-ink-900",children:[n.name,"季"]})]}),s.jsx("div",{className:"space-y-2",children:r.map(e=>{const t=y.has(e.id),a=(null==D?void 0:D.id)===e.id;return s.jsx("button",{onClick:()=>h(e),className:"w-full p-3 rounded-lg text-left transition-all "+(a?`bg-gradient-to-r ${n.gradient} text-white`:t?"bg-eco-50 border border-eco-200":"bg-gray-50 hover:bg-gray-100"),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium "+(a?"text-white":"text-ink-900"),children:e.name}),s.jsx("div",{className:"text-xs "+(a?"text-white/80":"text-ink-500"),children:e.date})]}),t&&!a&&s.jsx(i,{variant:"eco",className:"text-xs",children:"已参与"}),a&&s.jsx(i,{className:"bg-white/20 text-white text-xs",children:"进行中"})]})},e.id)})})]},e)})}),s.jsx(j,{children:m&&s.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>h(null),children:s.jsxs(d.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:`p-6 bg-gradient-to-br ${k[m.season].gradient} text-white rounded-t-2xl`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs(i,{className:"bg-white/20 text-white border-white/30 mb-2",children:[k[m.season].name,"季 · ",m.date]}),s.jsx("h3",{className:"text-2xl font-bold",children:m.name}),s.jsx("p",{className:"text-white/80 text-sm",children:m.englishName})]}),s.jsx("button",{onClick:()=>h(null),className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30",children:s.jsx(b,{className:"w-5 h-5"})})]}),s.jsx("p",{className:"mt-4 text-white/90",children:m.description})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"font-bold text-ink-900 mb-2 flex items-center gap-2",children:[s.jsx(x,{className:"w-5 h-5 text-eco-500"}),"生态主题"]}),s.jsx("p",{className:"text-ink-600",children:m.ecoTheme})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"font-bold text-ink-900 mb-2 flex items-center gap-2",children:[s.jsx(u,{className:"w-5 h-5 text-heritage-500"}),"关联非遗"]}),s.jsxs(c,{to:m.heritageLink,className:"flex items-center gap-2 p-3 bg-heritage-50 rounded-lg text-heritage-700 hover:bg-heritage-100 transition-colors",children:[s.jsx("span",{children:m.heritage}),s.jsx(p,{className:"w-4 h-4 ml-auto"})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"font-bold text-ink-900 mb-2 flex items-center gap-2",children:[s.jsx(N,{className:"w-5 h-5 text-amber-500"}),"活动内容"]}),s.jsx("div",{className:"space-y-2",children:m.activities.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-6 h-6 bg-eco-100 rounded-full flex items-center justify-center text-eco-600 text-sm font-medium",children:t+1}),s.jsx("span",{className:"text-ink-700",children:e})]},t))})]}),s.jsxs("div",{className:"p-4 bg-gradient-to-r from-eco-50 to-bamboo-50 rounded-xl mb-6",children:[s.jsxs("h4",{className:"font-bold text-eco-800 mb-3 flex items-center gap-2",children:[s.jsx(g,{className:"w-5 h-5"}),"活动奖励"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(f,{className:"w-5 h-5 text-amber-500"}),s.jsxs("span",{className:"font-bold text-eco-700",children:["+",m.rewards.points," 积分"]})]}),m.rewards.badge&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(w,{className:"w-5 h-5 text-eco-500"}),s.jsx("span",{className:"text-eco-700",children:m.rewards.badge})]}),m.rewards.nft&&s.jsx(i,{variant:"heritage",children:"限定NFT"})]})]}),y.has(m.id)?s.jsxs("div",{className:"p-4 bg-eco-50 rounded-xl text-center",children:[s.jsx(w,{className:"w-8 h-8 text-eco-500 mx-auto mb-2"}),s.jsx("p",{className:"text-eco-700 font-medium",children:"已参与此节气活动"})]}):s.jsxs(n,{variant:"eco",className:"w-full",onClick:()=>{var e;e=m,y.has(e.id)||(S(s=>new Set([...s,e.id])),C({type:"experience",points:e.rewards.points,description:`参与${e.name}节气活动`,relatedId:e.id}),A()),h(null)},children:["参与活动",s.jsx(p,{className:"w-5 h-5 ml-1"})]})]})]})})})]})}export{y as default};
