import{r as e,j as s}from"./three-vendor-BoyHWg1a.js";import{C as a}from"./Card-A_2Ty7OA.js";import{B as t}from"./Badge-DTmqmyMd.js";import{c as i,u as n,B as c}from"./index-DkRoqGlp.js";import{u as r}from"./ecoAchievementStore-30xRUVWQ.js";import{L as o,T as l,O as d,d as m,H as x,N as u,_ as h,aL as g,aM as p,ap as b,m as j,X as f,$ as y,aN as N,E as v}from"./ui-vendor-BCOa7pYq.js";import"./core-vendor-Csnc5NqJ.js";const w=e.forwardRef(({className:e,type:a,label:t,error:n,icon:c,...r},o)=>s.jsxs("div",{className:"w-full",children:[t&&s.jsx("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:t}),s.jsxs("div",{className:"relative",children:[c&&s.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-ink-400",children:c}),s.jsx("input",{type:a,className:i("flex h-11 w-full rounded-xl border border-ink-200 bg-white px-4 py-2 text-base text-ink-900 placeholder:text-ink-400","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50","transition-all duration-200",c&&"pl-10",n&&"border-red-500 focus:ring-red-500",e),ref:o,...r})]}),n&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:n})]}));w.displayName="Input";const k=[{id:"eco-wisdom",name:"ç”Ÿæ€æ™ºæ…§",category:"concept",description:"ä¼ ç»Ÿéžé—ä¸­è•´å«çš„äººä¸Žè‡ªç„¶å’Œè°å…±ç”Ÿçš„æ™ºæ…§",icon:o,color:"bg-eco-500",connections:["sustainable-dev","carbon-neutral","circular-economy"]},{id:"sustainable-dev",name:"å¯æŒç»­å‘å±•",category:"concept",description:"æ»¡è¶³å½“ä»£éœ€æ±‚è€Œä¸æŸå®³åŽä»£æ»¡è¶³å…¶éœ€æ±‚çš„èƒ½åŠ›",icon:l,color:"bg-green-500",connections:["eco-wisdom","carbon-neutral","biodiversity"]},{id:"carbon-neutral",name:"ç¢³ä¸­å’Œ",category:"concept",description:"é€šè¿‡å‡æŽ’å’Œç¢³æ±‡å®žçŽ°äºŒæ°§åŒ–ç¢³å‡€é›¶æŽ’æ”¾",icon:d,color:"bg-carbon-500",connections:["sustainable-dev","forest-carbon","low-carbon-travel"]},{id:"circular-economy",name:"å¾ªçŽ¯ç»æµŽ",category:"concept",description:"èµ„æºå¾ªçŽ¯åˆ©ç”¨ï¼Œå‡å°‘åºŸå¼ƒç‰©çš„ç»æµŽæ¨¡å¼",icon:d,color:"bg-amber-500",connections:["eco-wisdom","bamboo-plastic","natural-materials"]},{id:"hani-terrace",name:"å“ˆå°¼æ¢¯ç”°",category:"heritage",description:'ä¸–ç•Œæ–‡åŒ–é—äº§ï¼Œå±•ç¤º"å››ç´ åŒæž„"ç”Ÿæ€å†œä¸šæ™ºæ…§',icon:m,color:"bg-eco-600",connections:["water-cycle","biodiversity","sustainable-agriculture"],resources:[{title:"å“ˆå°¼æ¢¯ç”°VRä½“éªŒ",url:"/experience/hani-terrace"}]},{id:"bamboo-weaving",name:"è—¤ç¼–å·¥è‰º",category:"heritage",description:"ä»¥ç«¹ä»£å¡‘çš„ä¼ ç»Ÿæ‰‹å·¥è‰º",icon:o,color:"bg-bamboo-500",connections:["bamboo-plastic","natural-materials","circular-economy"],resources:[{title:"è—¤ç¼–ä½“éªŒ",url:"/experience/bamboo-weaving"}]},{id:"paper-cutting",name:"å‰ªçº¸è‰ºæœ¯",category:"heritage",description:"ä½¿ç”¨å¯é™è§£çº¸å¼ çš„ä¼ ç»Ÿè‰ºæœ¯",icon:o,color:"bg-red-500",connections:["natural-materials","biodegradable"],resources:[{title:"å‰ªçº¸ä½“éªŒ",url:"/experience/paper-cutting"}]},{id:"clay-sculpture",name:"å‡¤ç¿”æ³¥å¡‘",category:"heritage",description:"ä½¿ç”¨å¤©ç„¶é»„åœŸçš„ä¼ ç»Ÿå·¥è‰º",icon:x,color:"bg-amber-600",connections:["natural-materials","zero-pollution"],resources:[{title:"æ³¥å¡‘ä½“éªŒ",url:"/experience/fengxiang-clay"}]},{id:"shadow-puppet",name:"çš®å½±æˆ",category:"heritage",description:'ä½“çŽ°"ç‰©å°½å…¶ç”¨"å¾ªçŽ¯ç»æµŽç†å¿µ',icon:x,color:"bg-heritage-500",connections:["circular-economy","natural-materials"],resources:[{title:"çš®å½±ä½“éªŒ",url:"/experience/shadow-puppet"}]},{id:"tea-ceremony",name:"èŒ¶é“ç”Ÿæ€",category:"heritage",description:"æœ‰æœºèŒ¶å›­çš„ç”Ÿæ€ç³»ç»Ÿä¸Žç¢³æ±‡åŠŸèƒ½",icon:o,color:"bg-green-600",connections:["forest-carbon","biodiversity","organic-farming"],resources:[{title:"èŒ¶é“ä½“éªŒ",url:"/experience/tea-ceremony"}]},{id:"batik",name:"èœ¡æŸ“å·¥è‰º",category:"heritage",description:"ä½¿ç”¨å¤©ç„¶æ¤ç‰©æŸ“æ–™çš„ä¼ ç»ŸæŸ“è‰²æŠ€è‰º",icon:u,color:"bg-indigo-500",connections:["natural-dye","water-protection"],resources:[{title:"èœ¡æŸ“ä½“éªŒ",url:"/experience/batik"}]},{id:"bamboo-plastic",name:"ä»¥ç«¹ä»£å¡‘",category:"practice",description:"ç”¨ç«¹åˆ¶å“æ›¿ä»£å¡‘æ–™åˆ¶å“ï¼Œå‡å°‘å¡‘æ–™æ±¡æŸ“",icon:o,color:"bg-bamboo-600",connections:["bamboo-weaving","circular-economy","plastic-reduction"]},{id:"low-carbon-travel",name:"ä½Žç¢³äº‘æ¸¸",category:"practice",description:"é€šè¿‡æ•°å­—ä½“éªŒæ›¿ä»£å®žåœ°æ—…è¡Œï¼Œå‡å°‘ç¢³æŽ’æ”¾",icon:m,color:"bg-sky-500",connections:["carbon-neutral","digital-heritage"]},{id:"organic-farming",name:"æœ‰æœºç§æ¤",category:"practice",description:"ä¸ä½¿ç”¨åŒ–å­¦å†œè¯å’ŒåŒ–è‚¥çš„å†œä¸šæ–¹å¼",icon:o,color:"bg-green-500",connections:["tea-ceremony","biodiversity","soil-health"]},{id:"natural-materials",name:"å¤©ç„¶ææ–™",category:"material",description:"æ¥è‡ªè‡ªç„¶ã€å¯é™è§£çš„ä¼ ç»Ÿææ–™",icon:o,color:"bg-amber-500",connections:["bamboo-weaving","clay-sculpture","paper-cutting","biodegradable"]},{id:"natural-dye",name:"å¤©ç„¶æŸ“æ–™",category:"material",description:"ä»Žæ¤ç‰©ä¸­æå–çš„çŽ¯ä¿æŸ“æ–™",icon:u,color:"bg-indigo-600",connections:["batik","water-protection"]},{id:"biodegradable",name:"å¯é™è§£ææ–™",category:"material",description:"èƒ½è¢«è‡ªç„¶åˆ†è§£çš„çŽ¯ä¿ææ–™",icon:d,color:"bg-eco-500",connections:["natural-materials","paper-cutting","plastic-reduction"]},{id:"water-cycle",name:"æ°´å¾ªçŽ¯ç³»ç»Ÿ",category:"ecosystem",description:"è‡ªç„¶ç•Œæ°´çš„å¾ªçŽ¯åˆ©ç”¨ç³»ç»Ÿ",icon:u,color:"bg-blue-500",connections:["hani-terrace","sustainable-agriculture"]},{id:"biodiversity",name:"ç”Ÿç‰©å¤šæ ·æ€§",category:"ecosystem",description:"ç”Ÿæ€ç³»ç»Ÿä¸­ç‰©ç§çš„å¤šæ ·æ€§",icon:l,color:"bg-green-600",connections:["hani-terrace","tea-ceremony","sustainable-dev"]},{id:"forest-carbon",name:"æ£®æž—ç¢³æ±‡",category:"ecosystem",description:"æ£®æž—å¸æ”¶å’Œå‚¨å­˜äºŒæ°§åŒ–ç¢³çš„èƒ½åŠ›",icon:l,color:"bg-green-700",connections:["carbon-neutral","tea-ceremony","hani-terrace"]}],C={concept:{name:"æ ¸å¿ƒæ¦‚å¿µ",color:"bg-eco-100 text-eco-700"},heritage:{name:"éžé—é¡¹ç›®",color:"bg-heritage-100 text-heritage-700"},practice:{name:"ç”Ÿæ€å®žè·µ",color:"bg-blue-100 text-blue-700"},material:{name:"çŽ¯ä¿ææ–™",color:"bg-amber-100 text-amber-700"},ecosystem:{name:"ç”Ÿæ€ç³»ç»Ÿ",color:"bg-green-100 text-green-700"}};function $({className:i=""}){const[o,l]=e.useState(k),[d,m]=e.useState(null),[x,u]=e.useState(""),[$,z]=e.useState("all"),[M,S]=e.useState(1),[L,O]=e.useState(new Set),{addPoints:B}=n(),{updateKnowledgeGraphProgress:E}=r(),I=e.useRef(null),P=e.useMemo(()=>o.filter(e=>{const s=e.name.toLowerCase().includes(x.toLowerCase())||e.description.toLowerCase().includes(x.toLowerCase()),a="all"===$||e.category===$;return s&&a}),[o,x,$]),R=e.useMemo(()=>Math.round(L.size/o.length*100),[L,o]);e.useEffect(()=>{E(R)},[R,E]);const A=e.useCallback(e=>{m(e),L.has(e.id)||(O(s=>new Set([...s,e.id])),B({type:"learn",points:5,description:`æŽ¢ç´¢çŸ¥è¯†èŠ‚ç‚¹: ${e.name}`,relatedId:e.id}))},[L,B]),H=e.useCallback(e=>{const s=o.find(s=>s.id===e);return s?o.filter(e=>s.connections.includes(e.id)):[]},[o]),D=e.useMemo(()=>{const e={};return P.forEach((s,a)=>{const t=a/P.length*2*Math.PI,i=20*Object.keys(C).indexOf(s.category);e[s.id]={x:400+(250+i)*Math.cos(t),y:300+(250+i)*Math.sin(t)}}),e},[P]);return s.jsxs("div",{className:`${i}`,children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-ink-900",children:"ç”Ÿæ€çŸ¥è¯†å›¾è°±"}),s.jsx("p",{className:"text-ink-500",children:"æŽ¢ç´¢ç”Ÿæ€çŸ¥è¯†ä¹‹é—´çš„å…³è”ç½‘ç»œ"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(t,{variant:"eco",children:["å·²æŽ¢ç´¢ ",L.size,"/",o.length]}),s.jsxs(t,{variant:"outline",children:[R,"%"]})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[s.jsx(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ink-400"}),s.jsx(w,{placeholder:"æœç´¢çŸ¥è¯†èŠ‚ç‚¹...",value:x,onChange:e=>u(e.target.value),className:"pl-10"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(c,{variant:"all"===$?"eco":"outline",size:"sm",onClick:()=>z("all"),children:"å…¨éƒ¨"}),Object.entries(C).map(([e,a])=>s.jsx(c,{variant:$===e?"eco":"outline",size:"sm",onClick:()=>z(e),children:a.name},e))]})]})]}),s.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs(a,{className:"p-4 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(c,{variant:"outline",size:"sm",onClick:()=>S(e=>Math.max(.5,e-.1)),children:s.jsx(g,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-ink-500",children:[Math.round(100*M),"%"]}),s.jsx(c,{variant:"outline",size:"sm",onClick:()=>S(e=>Math.min(2,e+.1)),children:s.jsx(p,{className:"w-4 h-4"})})]}),s.jsxs(c,{variant:"outline",size:"sm",onClick:()=>S(1),children:[s.jsx(b,{className:"w-4 h-4 mr-1"}),"é‡ç½®"]})]}),s.jsxs("div",{ref:I,className:"relative bg-gradient-to-br from-eco-50 to-bamboo-50 rounded-xl overflow-auto",style:{height:"500px"},children:[s.jsx("svg",{width:800*M,height:600*M,className:"absolute inset-0",style:{transform:`scale(${M})`,transformOrigin:"top left"},children:P.map(e=>e.connections.map(a=>{if(!P.find(e=>e.id===a)||!D[e.id]||!D[a])return null;const t=D[e.id],i=D[a],n=d&&(d.id===e.id||d.id===a);return s.jsx("line",{x1:t.x,y1:t.y,x2:i.x,y2:i.y,stroke:n?"#22c55e":"#d1d5db",strokeWidth:n?2:1,strokeDasharray:n?"":"4",opacity:n?1:.5},`${e.id}-${a}`)}))}),P.map(e=>{const a=D[e.id];if(!a)return null;const t=(null==d?void 0:d.id)===e.id,i=null==d?void 0:d.connections.includes(e.id),n=L.has(e.id);return s.jsxs(j.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},className:"absolute transform -translate-x-1/2 -translate-y-1/2 "+(t?"z-20":i?"z-10":"z-0"),style:{left:a.x*M,top:a.y*M},onClick:()=>A(e),children:[s.jsx("div",{className:`\n                      w-12 h-12 rounded-full flex items-center justify-center\n                      ${e.color} text-white shadow-lg\n                      ${t?"ring-4 ring-eco-300 ring-offset-2":""}\n                      ${i?"ring-2 ring-eco-200":""}\n                      ${n?"":"opacity-70"}\n                      transition-all\n                    `,children:s.jsx(e.icon,{className:"w-6 h-6"})}),s.jsx("div",{className:`\n                      absolute top-full left-1/2 -translate-x-1/2 mt-1\n                      text-xs font-medium whitespace-nowrap\n                      ${t||i?"text-ink-900":"text-ink-500"}\n                    `,children:e.name}),n&&s.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-eco-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-[8px]",children:"âœ“"})})]},e.id)})]})]})}),s.jsxs("div",{className:"space-y-4",children:[d?s.jsxs(a,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("div",{className:`w-14 h-14 rounded-xl ${d.color} flex items-center justify-center text-white`,children:s.jsx(d.icon,{className:"w-7 h-7"})}),s.jsx("button",{onClick:()=>m(null),className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200",children:s.jsx(f,{className:"w-5 h-5 text-ink-600"})})]}),s.jsx(t,{className:C[d.category].color,children:C[d.category].name}),s.jsx("h3",{className:"text-xl font-bold text-ink-900 mt-3 mb-2",children:d.name}),s.jsx("p",{className:"text-ink-600 mb-4",children:d.description}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-ink-700 mb-2",children:"å…³è”çŸ¥è¯†"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:H(d.id).map(e=>s.jsx("button",{onClick:()=>A(e),className:"px-3 py-1 bg-gray-100 rounded-full text-sm text-ink-600 hover:bg-eco-100 hover:text-eco-700 transition-colors",children:e.name},e.id))})]}),d.resources&&d.resources.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-ink-700 mb-2",children:"å­¦ä¹ èµ„æº"}),s.jsx("div",{className:"space-y-2",children:d.resources.map((e,a)=>s.jsxs("a",{href:e.url,className:"flex items-center gap-2 p-3 bg-eco-50 rounded-lg text-eco-700 hover:bg-eco-100 transition-colors",children:[s.jsx(y,{className:"w-4 h-4"}),s.jsx("span",{className:"flex-1",children:e.title}),s.jsx(N,{className:"w-4 h-4"})]},a))})]})]}):s.jsxs(a,{className:"p-6 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-eco-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(h,{className:"w-8 h-8 text-eco-500"})}),s.jsx("h3",{className:"font-bold text-ink-900 mb-2",children:"é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹"}),s.jsx("p",{className:"text-sm text-ink-500",children:"ç‚¹å‡»å›¾è°±ä¸­çš„èŠ‚ç‚¹æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯å’Œå…³è”çŸ¥è¯†"})]}),s.jsxs(a,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-ink-900 mb-3",children:"æŽ¢ç´¢è¿›åº¦"}),s.jsxs("div",{className:"mb-2",children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-ink-500",children:"å·²æŽ¢ç´¢èŠ‚ç‚¹"}),s.jsxs("span",{className:"text-eco-600 font-medium",children:[L.size,"/",o.length]})]}),s.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx(j.div,{initial:{width:0},animate:{width:`${R}%`},className:"h-full bg-eco-500"})})]}),R>=50&&s.jsxs("div",{className:"mt-3 p-3 bg-eco-50 rounded-lg flex items-center gap-2",children:[s.jsx(v,{className:"w-5 h-5 text-eco-600"}),s.jsx("span",{className:"text-sm text-eco-700",children:R>=100?'ðŸŽ‰ å·²è§£é”"çŸ¥è¯†æŽ¢ç´¢è€…"å¾½ç« ï¼':"ç»§ç»­æŽ¢ç´¢è§£é”å¾½ç« "})]})]}),s.jsxs(a,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-ink-900 mb-3",children:"å›¾ä¾‹"}),s.jsx("div",{className:"space-y-2",children:Object.entries(C).map(([e,a])=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-4 h-4 rounded-full ${a.color.split(" ")[0].replace("100","500")}`}),s.jsx("span",{className:"text-sm text-ink-600",children:a.name})]},e))})]})]})]})]})}export{$ as default};
