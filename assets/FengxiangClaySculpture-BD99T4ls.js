import{c as f,r as i,j as e,L as q,S as D,A as z,m as C,P as A}from"./index-CCr_emsx.js";import{C as B,O as T,a as V}from"./OrbitControls-BPu6_TR5.js";import{O as G,V as M,C as U,p as X}from"./three.module-C2hvsvVY.js";import{C as Y}from"./chevron-left-B-sgjP4d.js";import{I as $}from"./info-BYklpjAM.js";import{R as _}from"./rotate-ccw-BwIt3_Ik.js";import{E as H}from"./Environment-CWdxoLYw.js";import"./constants-Ck1MbfUW.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=f("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=f("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=f("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=f("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),F=[{name:"æœ±çº¢",color:"#DC2626"},{name:"æ˜Žé»„",color:"#EAB308"},{name:"ç¿ ç»¿",color:"#16A34A"},{name:"å®è“",color:"#2563EB"},{name:"ç²‰ç™½",color:"#FDF2F8"},{name:"å¢¨é»‘",color:"#1C1917"}],O=[{id:"tiger",name:"è™Žå¤´",icon:"ðŸ¯"},{id:"horse",name:"é©¬",icon:"ðŸ´"},{id:"chicken",name:"é¸¡",icon:"ðŸ”"},{id:"fish",name:"é±¼",icon:"ðŸŸ"},{id:"custom",name:"è‡ªç”±",icon:"âœ¨"}];function W({selectedTool:r,selectedColor:x,onDeform:d}){const h=i.useRef(null),o=i.useRef(null),[g,p]=i.useState(!1),[c,y]=i.useState(new Map);i.useState(()=>{o.current=new G(1.5,32,32)});const u=n=>{if(n.stopPropagation(),p(!0),h.current&&o.current){const t=n.point,s=o.current.attributes.position;for(let a=0;a<s.count;a++){const N=s.getX(a),w=s.getY(a),k=s.getZ(a);t.distanceTo(new M(N,w,k))}const m=.5;for(let a=0;a<s.count;a++){const N=s.getX(a),w=s.getY(a),k=s.getZ(a),l=new M(N,w,k),P=t.distanceTo(l);if(P<m){const j=1-P/m,S=l.clone().sub(t).normalize();switch(r){case"pull":l.add(S.multiplyScalar(j*.1));break;case"push":l.sub(S.multiplyScalar(j*.1));break;case"smooth":l.lerp(t,j*.05);break;case"mold":l.add(S.multiplyScalar(j*.05));break;case"paint":y(Z=>new Map(Z).set(a,x));break}r!=="paint"&&s.setXYZ(a,l.x,l.y,l.z)}}r!=="paint"&&(s.needsUpdate=!0,o.current.computeVertexNormals()),d()}},b=()=>{p(!1)},v=n=>{g&&u(n)};return V(()=>{if(h.current&&o.current&&c.size>0){const n=new Float32Array(o.current.attributes.position.count*3);for(let t=0;t<n.length/3;t++){const s=c.get(t);if(s){const m=new U(s);n[t*3]=m.r,n[t*3+1]=m.g,n[t*3+2]=m.b}else n[t*3]=.9,n[t*3+1]=.8,n[t*3+2]=.7}o.current.setAttribute("color",new X(n,3))}}),e.jsx("mesh",{ref:h,geometry:o.current||void 0,onPointerDown:u,onPointerUp:b,onPointerMove:v,castShadow:!0,receiveShadow:!0,children:e.jsx("meshStandardMaterial",{vertexColors:c.size>0,color:c.size>0?void 0:"#E8D4B8",roughness:.8,metalness:.1})})}function J(){return e.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-2,0],receiveShadow:!0,children:[e.jsx("cylinderGeometry",{args:[3,3.5,.5,32]}),e.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.9})]})}function K({selectedTool:r,selectedColor:x,onDeform:d}){return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.4}),e.jsx("directionalLight",{position:[5,5,5],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024]}),e.jsx("pointLight",{position:[-5,3,-5],intensity:.5,color:"#FCD34D"}),e.jsx(W,{selectedTool:r,selectedColor:x,onDeform:d}),e.jsx(J,{}),e.jsx(T,{enablePan:!1,minDistance:3,maxDistance:8,minPolarAngle:Math.PI/6,maxPolarAngle:Math.PI/2}),e.jsx(H,{preset:"studio"})]})}function Q(){return e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-amber-950",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-amber-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-amber-200",children:"æ­£åœ¨åŠ è½½æ³¥å¡‘å·¥åŠ..."})]})})}function le(){var t;const[r,x]=i.useState("mold"),[d,h]=i.useState(F[0].color),[o,g]=i.useState(O[4]),[p,c]=i.useState(!0),[y,u]=i.useState(0),b=[{id:"mold",name:"å¡‘å½¢",icon:e.jsx(R,{className:"w-5 h-5"})},{id:"pull",name:"æ‹‰ä¼¸",icon:e.jsx(L,{className:"w-5 h-5"})},{id:"push",name:"æŒ‰åŽ‹",icon:e.jsx(E,{className:"w-5 h-5"})},{id:"smooth",name:"æŠšå¹³",icon:e.jsx(I,{className:"w-5 h-5"})},{id:"paint",name:"ä¸Šè‰²",icon:e.jsx(A,{className:"w-5 h-5"})}],v=i.useCallback(()=>{u(s=>s+1)},[]),n=()=>{u(0),window.location.reload()};return e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-amber-900 via-orange-900 to-stone-900",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between z-20",children:[e.jsxs(q,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-black/40 backdrop-blur rounded-full text-amber-100 hover:bg-black/60 transition-colors",children:[e.jsx(Y,{className:"w-5 h-5"}),"è¿”å›ž"]}),e.jsxs("h1",{className:"text-xl font-bold text-amber-100 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"å‡¤ç¿”æ³¥å¡‘"]}),e.jsx("button",{onClick:()=>c(!0),className:"p-2 bg-black/40 backdrop-blur rounded-full text-amber-100 hover:bg-black/60 transition-colors",children:e.jsx($,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"absolute inset-0 pt-16 pb-32",children:e.jsx(i.Suspense,{fallback:e.jsx(Q,{}),children:e.jsx(B,{shadows:!0,camera:{position:[0,2,5],fov:50},children:e.jsx(K,{selectedTool:r,selectedColor:d,onDeform:v})})})}),e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10",children:e.jsxs("div",{className:"bg-black/40 backdrop-blur rounded-2xl p-2 space-y-2",children:[b.map(s=>e.jsx("button",{onClick:()=>x(s.id),className:`
                w-12 h-12 rounded-xl flex items-center justify-center transition-all
                ${r===s.id?"bg-amber-500 text-white":"text-amber-200 hover:bg-white/10"}
              `,title:s.name,children:s.icon},s.id)),e.jsx("div",{className:"w-full h-px bg-white/20"}),e.jsx("button",{onClick:n,className:"w-12 h-12 rounded-xl flex items-center justify-center text-amber-200 hover:bg-white/10 transition-all",title:"é‡ç½®",children:e.jsx(_,{className:"w-5 h-5"})})]})}),e.jsx(z,{children:r==="paint"&&e.jsx(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"absolute right-4 top-1/2 -translate-y-1/2 z-10",children:e.jsx("div",{className:"bg-black/40 backdrop-blur rounded-2xl p-2 space-y-2",children:F.map(s=>e.jsx("button",{onClick:()=>h(s.color),className:`
                    w-10 h-10 rounded-full transition-all border-2
                    ${d===s.color?"border-white scale-110":"border-transparent hover:scale-105"}
                  `,style:{backgroundColor:s.color},title:s.name},s.color))})})}),e.jsx("div",{className:"absolute bottom-20 left-0 right-0 z-10",children:e.jsx("div",{className:"flex justify-center gap-3",children:O.map(s=>e.jsxs("button",{onClick:()=>g(s),className:`
                px-4 py-3 rounded-xl transition-all flex items-center gap-2
                ${o.id===s.id?"bg-amber-500 text-white":"bg-black/40 text-amber-200 hover:bg-black/60"}
              `,children:[e.jsx("span",{className:"text-xl",children:s.icon}),e.jsx("span",{className:"text-sm",children:s.name})]},s.id))})}),e.jsx("div",{className:"absolute bottom-6 left-0 right-0 z-10",children:e.jsxs("div",{className:"flex justify-center items-center gap-6 text-amber-200/60 text-sm",children:[e.jsxs("span",{children:["å½“å‰å·¥å…·: ",(t=b.find(s=>s.id===r))==null?void 0:t.name]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["æ“ä½œæ¬¡æ•°: ",y]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:"æ‹–åŠ¨é¼ æ ‡åœ¨æ³¥å¡‘ä¸Šæ“ä½œ"})]})}),e.jsx(z,{children:p&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 flex items-center justify-center z-30 bg-black/70",onClick:()=>c(!1),children:e.jsxs(C.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:s=>s.stopPropagation(),className:"bg-amber-950 border border-amber-600/50 rounded-2xl p-8 max-w-lg mx-4",children:[e.jsxs("h2",{className:"text-2xl font-bold text-amber-100 mb-6 flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6"}),"å‡¤ç¿”æ³¥å¡‘å·¥åŠ"]}),e.jsxs("div",{className:"space-y-4 text-amber-200/80",children:[e.jsx("p",{children:'å‡¤ç¿”æ³¥å¡‘æ˜¯é™•è¥¿çœå®é¸¡å¸‚å‡¤ç¿”åŒºçš„ä¼ ç»Ÿæ°‘é—´è‰ºæœ¯ï¼Œè¢«èª‰ä¸º"ä¸­å›½æ³¥å¡‘è‰ºæœ¯ä¹‹ä¹¡"ã€‚'}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"å¡‘å½¢"})," - åŸºç¡€é€ åž‹å·¥å…·"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"æ‹‰ä¼¸"})," - å‘å¤–æ‹‰ä¼¸æ³¥å¡‘"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"æŒ‰åŽ‹"})," - å‘å†…æŒ‰åŽ‹æ³¥å¡‘"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"æŠšå¹³"})," - å¹³æ»‘è¡¨é¢"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"ä¸Šè‰²"})," - æ¶‚æŠ¹ä¼ ç»Ÿè‰²å½©"]})]})]}),e.jsx("div",{className:"p-4 bg-black/30 rounded-xl",children:e.jsx("p",{className:"text-sm",children:"ðŸ’¡ å‡¤ç¿”æ³¥å¡‘ä»¥å…¶é²œè‰³çš„è‰²å½©å’Œå¤¸å¼ çš„é€ åž‹è‘—ç§°ï¼Œå¸¸è§é¢˜ææœ‰è™Žã€é©¬ã€çŒ´ç­‰å‰ç¥¥åŠ¨ç‰©ã€‚"})})]}),e.jsx("button",{onClick:()=>c(!1),className:"mt-6 w-full py-3 bg-amber-600 hover:bg-amber-500 text-white rounded-xl font-semibold transition-colors",children:"å¼€å§‹åˆ›ä½œ"})]})})})]})}export{le as default};
