import{r as e,j as t}from"./three-vendor-BoyHWg1a.js";import s from"./RetroPolaroidCamera-BVnU_yGL.js";import{c as a}from"./index-DkRoqGlp.js";import{m as l,f as i,A as r,a1 as n,X as o,U as c,au as d,L as x,u as m,ab as h,av as p,aq as u,o as b,aw as g,ax as j,g as f}from"./ui-vendor-BCOa7pYq.js";import{u as v}from"./artworkStore-DQwkUevd.js";import{a as N}from"./core-vendor-Csnc5NqJ.js";function w({color:e="red"}){return t.jsxs("div",{className:"absolute -top-2 left-1/2 -translate-x-1/2 z-10",children:[t.jsx("div",{className:a("w-5 h-5 rounded-full bg-gradient-to-br shadow-lg",{red:"from-red-500 to-red-700",yellow:"from-yellow-400 to-yellow-600",green:"from-green-500 to-green-700",blue:"from-blue-500 to-blue-700"}[e]),style:{boxShadow:"0 2px 4px rgba(0,0,0,0.3), inset 0 1px 2px rgba(255,255,255,0.3)"},children:t.jsx("div",{className:"absolute top-1 left-1 w-2 h-2 rounded-full bg-white/40"})}),t.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 w-1 h-3 bg-gradient-to-b from-gray-400 to-gray-600",style:{clipPath:"polygon(50% 100%, 0 0, 100% 0)"}})]})}function y({photo:s,rotation:i,onClick:o,onLike:c}){const[d,x]=e.useState(!1),[m,h]=e.useState(!1),p=e=>{e.stopPropagation(),d||(x(!0),h(!0),setTimeout(()=>h(!1),600),c())};return t.jsxs(l.div,{className:"relative cursor-pointer group",style:{transform:`rotate(${i}deg)`},whileHover:{scale:1.05,rotate:0,zIndex:20,transition:{duration:.2}},onClick:o,onDoubleClick:e=>{e.stopPropagation(),d||p(e)},children:[t.jsx(w,{color:["red","yellow","green","blue"][Math.floor(4*Math.random())]}),t.jsxs("div",{className:"bg-white p-2 pb-10 rounded-sm shadow-lg transition-shadow group-hover:shadow-2xl",style:{boxShadow:"0 4px 12px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.1)"},children:[t.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gray-100",children:[t.jsx("img",{src:s.image,alt:s.title,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/10 to-transparent mix-blend-overlay"}),t.jsx(r,{children:m&&t.jsx(l.div,{initial:{scale:0,opacity:1},animate:{scale:1.5,opacity:0},exit:{opacity:0},className:"absolute inset-0 flex items-center justify-center",children:t.jsx(n,{className:"w-16 h-16 text-white fill-red-500 drop-shadow-lg"})})})]}),t.jsxs("div",{className:"absolute bottom-2 left-2 right-2",children:[t.jsx("p",{className:"font-handwriting text-gray-700 text-sm truncate",children:s.title}),t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx("p",{className:"text-xs text-gray-400",children:s.date}),t.jsxs("button",{onClick:p,className:"flex items-center gap-1 text-xs text-gray-400 hover:text-red-500 transition-colors",children:[t.jsx(n,{className:a("w-3 h-3",d&&"fill-red-500 text-red-500")}),s.likes+(d?1:0)]})]})]})]})]})}function k({photo:s,onClose:a}){const[i,r]=e.useState(!1);return t.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:a,children:t.jsxs(l.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:e=>e.stopPropagation(),className:"relative max-w-md w-full",children:[t.jsx("button",{onClick:a,className:"absolute -top-12 right-0 p-2 text-white/80 hover:text-white transition-colors",children:t.jsx(o,{className:"w-6 h-6"})}),t.jsx("div",{className:"relative cursor-pointer perspective-1000",onClick:()=>r(!i),children:t.jsxs(l.div,{className:"relative preserve-3d",animate:{rotateY:i?180:0},transition:{duration:.6,type:"spring",stiffness:100},style:{transformStyle:"preserve-3d"},children:[t.jsxs("div",{className:"bg-white p-4 pb-20 rounded-sm shadow-2xl backface-hidden",style:{backfaceVisibility:"hidden"},children:[t.jsx("div",{className:"aspect-square overflow-hidden bg-gray-100 rounded",children:t.jsx("img",{src:s.image,alt:s.title,className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[t.jsx("p",{className:"font-handwriting text-gray-800 text-xl",children:s.title}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(c,{className:"w-4 h-4"}),s.creator]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(d,{className:"w-4 h-4"}),s.date]})]})]}),t.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/30 rounded text-white text-xs",children:"ç‚¹å‡»ç¿»è½¬"})]}),t.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-50 to-orange-50 p-6 rounded-sm shadow-2xl backface-hidden flex flex-col",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:[t.jsx("div",{className:"absolute inset-4 border border-amber-200 rounded pointer-events-none"}),t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[t.jsx(x,{className:"w-10 h-10 text-eco-500 mb-4"}),t.jsx("p",{className:"text-amber-600 font-medium mb-4",children:"ç§˜å¯†å¯„è¯­"}),t.jsx("div",{className:"bg-white/80 rounded-xl p-4 w-full",children:t.jsx("p",{className:"text-center text-amber-800 leading-relaxed",children:s.message})})]}),t.jsx("div",{className:"text-center text-xs text-amber-400 mt-4",children:"ä¹¡é—è¯† Â· ç”Ÿæ€æ™ºæ…§å¹³å°"})]})]})}),t.jsxs("div",{className:"flex gap-3 mt-4",children:[t.jsxs("button",{className:"flex-1 py-3 bg-white/90 hover:bg-white text-amber-700 rounded-xl font-medium flex items-center justify-center gap-2 transition-colors",children:[t.jsx(n,{className:"w-5 h-5"}),"å–œæ¬¢"]}),t.jsxs("button",{className:"flex-1 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 transition-colors",children:[t.jsx(m,{className:"w-5 h-5"}),"åˆ†äº«"]})]})]})})}function C({photos:s,onPhotoClick:n,className:o}){const[c,d]=e.useState(null),x=e.useMemo(()=>s.map(()=>12*(Math.random()-.5)),[s]);return t.jsxs("div",{className:a("relative",o),children:[t.jsxs("div",{className:"absolute inset-0 rounded-2xl",style:{background:"\n            linear-gradient(135deg, #d4a574 0%, #c49a6c 25%, #b8906a 50%, #c49a6c 75%, #d4a574 100%)\n          ",boxShadow:"inset 0 2px 10px rgba(0,0,0,0.2), 0 4px 20px rgba(0,0,0,0.15)"},children:[t.jsx("div",{className:"absolute inset-0 opacity-30 rounded-2xl",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E\")"}}),t.jsx("div",{className:"absolute inset-0 rounded-2xl border-8 border-amber-900/30"})]}),t.jsxs("div",{className:"relative p-6",children:[t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:s.map((e,s)=>t.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},children:t.jsx(y,{photo:e,rotation:x[s],onClick:()=>(e=>{d(e),null==n||n(e)})(e),onLike:()=>{e.id}})},e.id))}),0===s.length&&t.jsxs("div",{className:"text-center py-20",children:[t.jsx(i,{className:"w-16 h-16 text-amber-300 mx-auto mb-4"}),t.jsx("p",{className:"text-amber-700 font-medium",children:"è¿˜æ²¡æœ‰ç…§ç‰‡"}),t.jsx("p",{className:"text-amber-500 text-sm mt-1",children:"å¿«æ¥æ‹æ‘„ç¬¬ä¸€å¼ å§ï¼"})]})]}),t.jsx(r,{children:c&&t.jsx(k,{photo:c,onClose:()=>d(null)})})]})}function S(e){return"weaving"===e.type?e.title:e.sceneName}function P(e){if("weaving"===e.type){const t=e;return`${t.craftLevel} Â· ${t.productStyle}`}return e.ecoMessage}function z(){const a=N(),[i,c]=e.useState("all"),[d,w]=e.useState("grid"),[y,k]=e.useState(null),[z,M]=e.useState(new Set),[A,E]=e.useState(!1),[L,q]=e.useState(new Set),{artworks:D,removeArtwork:T,getWeavingArtworks:$,getPolaroidArtworks:F}=v(),I=e.useMemo(()=>"weaving"===i?$():"polaroid"===i?F():D,[D,i,$,F]),V=e.useMemo(()=>I.map(e=>({id:e.id,image:e.image,title:S(e),creator:"æˆ‘",date:new Date(e.createdAt).toLocaleDateString("zh-CN"),message:P(e),likes:0,scene:"polaroid"===e.type?e.scene:"bamboo_forest"})),[I]),Y=(e,t)=>{null==t||t.stopPropagation(),z.has(e)||(q(t=>new Set(t).add(e)),setTimeout(()=>{q(t=>{const s=new Set(t);return s.delete(e),s})},600)),M(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:[t.jsx("div",{className:"pt-20 pb-6 px-4",children:t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"æˆ‘çš„ä½œå“é›†"}),t.jsx("p",{className:"text-slate-500",children:D.length>0?`å·²åˆ›ä½œ ${D.length} ä»¶ä½œå“`:"å¼€å§‹ä½ çš„éé—åˆ›ä½œä¹‹æ—…å§ï¼"})]})}),t.jsx("div",{className:"sticky top-16 z-20 bg-white/80 backdrop-blur-lg border-b border-slate-100",children:t.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>c("all"),className:"px-4 py-2 rounded-full text-sm font-medium transition-all "+("all"===i?"bg-emerald-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:["å…¨éƒ¨ (",D.length,")"]}),t.jsxs("button",{onClick:()=>c("weaving"),className:"px-4 py-2 rounded-full text-sm font-medium transition-all "+("weaving"===i?"bg-amber-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:["ğŸ‹ ç¼–ç»‡ (",$().length,")"]}),t.jsxs("button",{onClick:()=>c("polaroid"),className:"px-4 py-2 rounded-full text-sm font-medium transition-all "+("polaroid"===i?"bg-sky-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:["ğŸ“· æ‹ç«‹å¾— (",F().length,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex bg-slate-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>w("grid"),className:"p-2 rounded-md transition-all "+("grid"===d?"bg-white shadow-sm text-emerald-600":"text-slate-500 hover:text-slate-700"),title:"ç½‘æ ¼è§†å›¾",children:t.jsx(h,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>w("corkboard"),className:"p-2 rounded-md transition-all "+("corkboard"===d?"bg-white shadow-sm text-amber-600":"text-slate-500 hover:text-slate-700"),title:"è½¯æœ¨æ¿è§†å›¾",children:t.jsx(p,{className:"w-4 h-4"})})]}),t.jsxs("button",{onClick:()=>a("/experience/bamboo-weaving"),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full text-sm font-medium transition-all",children:[t.jsx(u,{className:"w-4 h-4"}),"å¼€å§‹ç¼–ç»‡"]}),t.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-full text-sm font-medium transition-all shadow-lg shadow-amber-500/30",children:[t.jsx(b,{className:"w-4 h-4"}),"æ‹ç«‹å¾—"]})]})]})})}),t.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:t.jsxs(r,{mode:"wait",children:[0===I.length&&t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20",children:[t.jsx(g,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-slate-600 mb-2",children:"è¿˜æ²¡æœ‰ä½œå“"}),t.jsxs("p",{className:"text-slate-400 mb-6",children:["weaving"===i&&"å»ä½“éªŒè—¤ç¼–å·¥è‰ºï¼Œåˆ›ä½œä½ çš„ç¬¬ä¸€ä»¶ä½œå“å§ï¼","polaroid"===i&&"å»æ‹æ‘„ä½ çš„ç¬¬ä¸€å¼ ä½ç¢³äº‘æ¸¸çºªå¿µç…§å§ï¼","all"===i&&"å¼€å§‹ä½ çš„éé—åˆ›ä½œä¹‹æ—…å§ï¼"]}),t.jsx("button",{onClick:()=>a("/experience/bamboo-weaving"),className:"px-6 py-3 bg-emerald-500 text-white rounded-full font-medium hover:bg-emerald-600 transition-colors",children:"å¼€å§‹åˆ›ä½œ"})]}),"grid"===d&&I.length>0&&t.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map((e,s)=>t.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},onClick:()=>k(e),className:"group cursor-pointer",children:t.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[t.jsx("div",{className:"absolute top-3 left-3 z-10",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("weaving"===e.type?"bg-amber-100 text-amber-700":"bg-sky-100 text-sky-700"),children:"weaving"===e.type?"ğŸ‹ ç¼–ç»‡":"ğŸ“· æ‹ç«‹å¾—"})}),t.jsx("div",{className:"aspect-square overflow-hidden relative",children:t.jsx("img",{src:e.image,alt:S(e),className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"})}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-semibold text-slate-800 mb-1 truncate",children:S(e)}),t.jsx("p",{className:"text-sm text-slate-500 mb-3 truncate",children:P(e)}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-1 text-emerald-600",children:[t.jsx(x,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm font-medium",children:["-",e.carbonSaved,"g"]})]}),t.jsxs("button",{onClick:t=>Y(e.id,t),className:"relative flex items-center gap-1 text-slate-500 hover:text-rose-500 transition-colors",children:[t.jsx(n,{className:"w-4 h-4 transition-all duration-200 "+(z.has(e.id)?"fill-rose-500 text-rose-500 scale-110":"")}),L.has(e.id)&&t.jsx(l.span,{initial:{scale:1,opacity:1},animate:{scale:2,opacity:0},className:"absolute inset-0 flex items-center justify-center",children:t.jsx(n,{className:"w-4 h-4 fill-rose-500 text-rose-500"})})]})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-2",children:new Date(e.createdAt).toLocaleDateString("zh-CN")})]})]})},e.id))},"grid"),"corkboard"===d&&I.length>0&&t.jsx(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:t.jsx(C,{photos:V})},"corkboard")]})}),t.jsx(r,{children:A&&t.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>E(!1),children:t.jsx(l.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),className:"max-w-md w-full max-h-[90vh] overflow-y-auto",children:t.jsx(s,{onClose:()=>E(!1),onComplete:()=>E(!1)})})})}),t.jsx(r,{children:y&&t.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>k(null),children:t.jsxs(l.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-3xl overflow-hidden max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl relative",children:[t.jsx("button",{onClick:()=>k(null),className:"absolute top-4 right-4 z-10 p-2 bg-black/20 hover:bg-black/40 rounded-full text-white transition-colors",children:t.jsx(o,{className:"w-5 h-5"})}),t.jsx("div",{className:"aspect-square",children:t.jsx("img",{src:y.image,alt:S(y),className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("weaving"===y.type?"bg-amber-100 text-amber-700":"bg-sky-100 text-sky-700"),children:"weaving"===y.type?"ğŸ‹ ç¼–ç»‡ä½œå“":"ğŸ“· æ‹ç«‹å¾—ç…§ç‰‡"}),t.jsx("h2",{className:"text-2xl font-bold text-slate-800 mt-2",children:S(y)}),t.jsx("p",{className:"text-slate-500 mt-1",children:P(y)})]}),t.jsx("button",{onClick:e=>((e,t)=>{null==t||t.stopPropagation(),confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œå“å—ï¼Ÿ")&&(T(e),k(null))})(y.id,e),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",title:"åˆ é™¤ä½œå“",children:t.jsx(j,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-4 p-4 bg-emerald-50 rounded-xl mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-5 h-5 text-emerald-500"}),t.jsxs("span",{className:"text-emerald-700 font-medium",children:["-",y.carbonSaved,"g ç¢³å‡æ’"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(f,{className:"w-5 h-5 text-amber-500"}),t.jsxs("span",{className:"text-amber-700 font-medium",children:["+",y.pointsEarned," ç»¿è‰²ç§¯åˆ†"]})]})]}),"weaving"===y.type&&t.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-slate-50 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-amber-600",children:Math.round(y.smoothness)}),t.jsx("p",{className:"text-xs text-slate-500",children:"å¹³æ»‘åº¦"})]}),t.jsxs("div",{className:"bg-slate-50 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-amber-600",children:Math.round(y.creativity)}),t.jsx("p",{className:"text-xs text-slate-500",children:"åˆ›æ„åº¦"})]}),t.jsxs("div",{className:"bg-slate-50 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-amber-600",children:Math.round(y.persistence)}),t.jsx("p",{className:"text-xs text-slate-500",children:"åšæŒåº¦"})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:()=>Y(y.id),className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-medium transition-all "+(z.has(y.id)?"bg-rose-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[t.jsx(n,{className:"w-5 h-5 "+(z.has(y.id)?"fill-white":"")}),z.has(y.id)?"å·²æ”¶è—":"æ”¶è—"]}),t.jsxs("button",{onClick:e=>((e,t)=>{null==t||t.stopPropagation();const s=S(e);navigator.share?navigator.share({title:s,text:`æ¥çœ‹çœ‹æˆ‘çš„éé—åˆ›ä½œã€Œ${s}ã€`,url:window.location.href}).catch(()=>{}):(navigator.clipboard.writeText(window.location.href),alert("é“¾æ¥å·²å¤åˆ¶ï¼Œå¿«å»åˆ†äº«ç»™å¥½å‹å§ï¼"))})(y,e),className:"flex-1 flex items-center justify-center gap-2 py-3 bg-emerald-500 text-white rounded-xl font-medium hover:bg-emerald-600 transition-colors",children:[t.jsx(m,{className:"w-5 h-5"}),"åˆ†äº«"]})]}),t.jsxs("p",{className:"text-center text-sm text-slate-400 mt-4",children:["åˆ›ä½œäº ",new Date(y.createdAt).toLocaleString("zh-CN")]})]})]})})})]})}export{z as default};
