const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ShadowPuppetCreator--PvAaow1.js","assets/three-vendor-BoyHWg1a.js","assets/ui-vendor-BCOa7pYq.js"])))=>i.map(i=>d[i]);
import{r as e,j as s,_ as a}from"./three-vendor-BoyHWg1a.js";import{u as t,a as l}from"./index-D20SIRsj.js";import{a as r}from"./core-vendor-Csnc5NqJ.js";import{X as i,w as n,aA as c,V as d,A as o,m,g as x,L as b,Q as h,r as u,a8 as g,aC as p,J as j,o as f}from"./ui-vendor-BCOa7pYq.js";const N=e.lazy(()=>a(()=>import("./ShadowPuppetCreator--PvAaow1.js"),__vite__mapDeps([0,1,2]))),v=[{id:"xixiang",title:"è¥¿å¢è®°",description:"å¼ ç”Ÿä¸å´”èºèºçš„çˆ±æƒ…æ•…äº‹",characters:[{id:"cuiyingying",name:"å´”èºèº",role:"æ—¦è§’",imageUrl:null},{id:"zhangsheng",name:"å¼ ç”Ÿ",role:"ç”Ÿè§’",imageUrl:null}],ecoMessage:"ä¸€å¼ ç‰›çš®æ‰¿è½½åƒå¹´çˆ±æƒ…ï¼Œä¼ æ‰¿ç™¾ä»£",duration:60,isCreated:!1},{id:"sanguo",title:"ä¸‰è‹±æˆ˜å•å¸ƒ",description:"åˆ˜å…³å¼ å¤§æˆ˜å•å¸ƒ",characters:[{id:"guanyu",name:"å…³ç¾½",role:"å‡€è§’",imageUrl:null},{id:"zhaoyun",name:"èµµäº‘",role:"æ­¦ç”Ÿ",imageUrl:null}],ecoMessage:"ä¼ ç»Ÿçš®é©å·¥è‰ºï¼Œæ¤ç‰©é£åˆ¶é›¶æ±¡æŸ“",duration:55,isCreated:!1},{id:"mulan",title:"æœ¨å…°ä»å†›",description:"èŠ±æœ¨å…°ä»£çˆ¶å‡ºå¾",characters:[{id:"mulan",name:"èŠ±æœ¨å…°",role:"æ­¦æ—¦",imageUrl:null}],ecoMessage:"çš®å½±æˆä¸­çš„å·¾å¸¼ä¸è®©é¡»çœ‰",duration:50,isCreated:!1},{id:"baishe",title:"ç™½è›‡ä¼ ",description:"ç™½å¨˜å­ä¸è®¸ä»™çš„æ•…äº‹",characters:[{id:"baisuzhen",name:"ç™½ç´ è´",role:"é’è¡£",imageUrl:null},{id:"xuxian",name:"è®¸ä»™",role:"å°ç”Ÿ",imageUrl:null}],ecoMessage:"åƒå¹´ä¼ è¯´ï¼Œçš®å½±æ¼”ç»",duration:60,isCreated:!1}];function w({character:a,x:t,y:l,isActive:r,onDrag:i}){const n=e.useRef(null),[c,d]=e.useState(!1),o=e.useCallback(e=>{if(c&&n.current){const s=n.current.parentElement;if(s){const a=s.getBoundingClientRect(),t=(e.clientX-a.left)/a.width*100,l=(e.clientY-a.top)/a.height*100;null==i||i(Math.max(10,Math.min(90,t)),Math.max(15,Math.min(85,l)))}}},[c,i]),x=e.useCallback(()=>{d(!1)},[]);return e.useEffect(()=>{if(c)return window.addEventListener("mousemove",o),window.addEventListener("mouseup",x),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",x)}},[c,o,x]),a.imageUrl?s.jsxs(m.div,{ref:n,className:"absolute cursor-grab active:cursor-grabbing select-none",style:{left:`${t}%`,top:`${l}%`,transform:"translate(-50%, -50%)",filter:r?"drop-shadow(0 0 30px rgba(255,200,100,0.6))":"drop-shadow(2px 4px 6px rgba(0,0,0,0.3))"},animate:{y:r?[0,-8,0]:0,rotate:r?[-2,2,-2]:0},transition:{duration:2,repeat:r?1/0:0,ease:"easeInOut"},onMouseDown:e=>{e.preventDefault(),d(!0)},children:[s.jsx("img",{src:a.imageUrl,alt:a.name,className:"h-64 md:h-80 w-auto object-contain",draggable:!1}),s.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:s.jsx("span",{className:"px-3 py-1 bg-amber-900/80 text-amber-100 text-sm rounded-full",children:a.name})})]}):null}function y(){const a=r(),y=e.useRef(null),{addPoints:C}=t(),{addCarbonSaving:k}=l(),[S,z]=e.useState("intro"),[M,E]=e.useState(v),[I,U]=e.useState(null),[_,D]=e.useState(!1),[L,A]=e.useState(!1),[P,R]=e.useState(0),[$,H]=e.useState(!1),[O,V]=e.useState(!1),[B,J]=e.useState({}),Q=M.find(e=>e.id===I)||null;e.useEffect(()=>{if(Q&&"perform"===S){const e={};Q.characters.forEach((s,a)=>{e[s.id]={x:25+50*a,y:50}}),J(e)}},[Q,S]),e.useEffect(()=>{if("perform"===S&&L&&Q){const e=setInterval(()=>{const e=Date.now();J(s=>{const a={...s};return Q.characters.forEach((t,l)=>{s[t.id]&&(a[t.id]={x:25+50*l+15*Math.sin(e/2e3+l),y:50+8*Math.sin(e/1500+.5*l)})}),a})},50),s=setInterval(()=>{R(a=>{const t=100/Q.duration;return a>=100?(A(!1),H(!0),clearInterval(e),clearInterval(s),C({type:"experience",points:80,description:"å®Œæˆçš®å½±æˆè¡¨æ¼”ä½“éªŒ"}),k({type:"digital_experience",carbonSaved:350,description:"ä¼ ç»Ÿçš®å½±å¾ªç¯åˆ©ç”¨ä½“éªŒ",experienceId:"shadow_puppet"}),100):a+t})},1e3);return()=>{clearInterval(e),clearInterval(s)}}},[S,L,Q,C,k]);const T=e=>{e.isCreated&&(U(e.id),z("perform"),R(0),A(!0),H(!1))};return s.jsxs("div",{className:"relative w-full h-screen overflow-hidden bg-gradient-to-b from-amber-950 via-amber-900 to-amber-950",children:[s.jsx("button",{onClick:()=>a("/"),className:"absolute top-4 left-4 z-50 p-2 bg-black/30 hover:bg-black/50 rounded-full text-white/80 transition-colors",children:s.jsx(i,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:()=>z("select"),className:"absolute top-4 right-4 z-50 px-4 py-2 bg-amber-600 hover:bg-amber-700 rounded-full text-white text-sm flex items-center gap-2 transition-colors",children:[s.jsx(n,{className:"w-4 h-4"}),"å¼€å§‹æ¼”ç¤º"]}),s.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(ellipse 90% 70% at 50% 45%, \n            rgba(255,248,230,1) 0%,\n            rgba(255,238,200,1) 15%,\n            rgba(255,215,155,1) 30%,\n            rgba(240,185,115,1) 50%,\n            rgba(200,140,70,1) 70%,\n            rgba(140,85,40,1) 85%,\n            rgba(60,35,18,1) 100%\n          )"}}),s.jsxs("div",{className:"absolute top-16 left-1/2 -translate-x-1/2 flex items-center gap-4 z-30",children:[s.jsx("img",{src:"/images/æœ¨çª—æ¡†å…ƒç´ .png",alt:"",className:"h-12 opacity-90"}),s.jsx("span",{className:"text-amber-100 text-2xl font-bold tracking-[0.5em] drop-shadow-lg",children:"å…‰ å½± æˆ å°"}),s.jsx("img",{src:"/images/æœ¨çª—æ¡†å…ƒç´ .png",alt:"",className:"h-12 opacity-90 scale-x-[-1]"})]}),s.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:s.jsx("button",{onClick:()=>V(!O),className:"p-2 bg-black/30 hover:bg-black/50 rounded-full text-white/80",children:O?s.jsx(c,{className:"w-4 h-4"}):s.jsx(d,{className:"w-4 h-4"})})}),s.jsx(o,{children:"intro"===S&&s.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-40 flex items-center justify-center",children:s.jsxs(m.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},className:"bg-gradient-to-b from-amber-100/95 to-amber-50/95 backdrop-blur-sm rounded-3xl p-8 max-w-lg mx-4 shadow-2xl text-center",children:[s.jsx(x,{className:"w-12 h-12 text-amber-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-3xl font-bold text-amber-900 mb-2",children:"ğŸ­ çš®å½±æˆ Â· å…‰å½±ä¼ å¥‡"}),s.jsx("p",{className:"text-amber-600 mb-6",children:"ä¸¤åƒå¹´çš„å…‰å½±è‰ºæœ¯ï¼ŒæŒ‡å°–ä¸Šçš„ä¸­åæ–‡åŒ–"}),s.jsxs("div",{className:"bg-eco-50 rounded-xl p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 text-eco-700 mb-2",children:[s.jsx(b,{className:"w-4 h-4"}),s.jsx("span",{className:"font-bold",children:"å¾ªç¯ç»æµ Â· ç™¾å¹´ä¼ æ‰¿"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{className:"bg-white rounded-lg p-2",children:[s.jsx("div",{className:"text-eco-600 font-bold",children:"100å¹´+"}),s.jsx("div",{className:"text-eco-500 text-xs",children:"ä¼ ç»Ÿçš®å½±å¯¿å‘½"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-2",children:[s.jsx("div",{className:"text-eco-600 font-bold",children:"100%"}),s.jsx("div",{className:"text-eco-500 text-xs",children:"å¤©ç„¶ç‰›çš®ææ–™"})]})]})]}),s.jsxs("button",{onClick:()=>z("select"),className:"w-full py-4 bg-gradient-to-r from-amber-500 to-amber-600 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2",children:[s.jsx(h,{className:"w-5 h-5"}),"é€‰æ‹©å‰§ç›®å¼€å§‹åˆ›å»º",s.jsx(u,{className:"w-5 h-5"})]})]})})}),s.jsx(o,{children:"select"===S&&s.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-40 flex items-center justify-center bg-black/50 p-4",children:s.jsxs(m.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-gradient-to-b from-amber-100 to-amber-50 rounded-3xl p-6 max-w-2xl w-full shadow-2xl max-h-[85vh] overflow-y-auto",children:[s.jsx("h3",{className:"text-2xl font-bold text-amber-900 mb-2 text-center",children:"é€‰æ‹©å‰§ç›®"}),s.jsx("p",{className:"text-amber-600 text-center mb-6",children:"å·²åˆ›å»ºçš„å‰§ç›®å¯ç›´æ¥æ’­æ”¾ï¼Œæœªåˆ›å»ºéœ€å…ˆä¸Šä¼ è§’è‰²"}),s.jsx("div",{className:"space-y-4",children:M.map(e=>s.jsxs(m.div,{whileHover:{scale:1.01},className:"w-full bg-white/80 rounded-2xl p-4 transition-colors shadow-sm "+(e.isCreated?"hover:bg-white border-2 border-green-300":"border-2 border-amber-200"),children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-xl flex items-center justify-center text-3xl "+(e.isCreated?"bg-gradient-to-br from-green-200 to-green-300":"bg-gradient-to-br from-amber-200 to-amber-300"),children:e.isCreated?"âœ…":"ğŸ­"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-bold text-lg text-amber-900",children:e.title}),e.isCreated&&s.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"å·²åˆ›å»º"})]}),s.jsx("p",{className:"text-amber-600 text-sm mb-2",children:e.description}),s.jsx("div",{className:"flex items-center gap-3 text-xs text-amber-500",children:s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(g,{className:"w-3 h-3"}),e.characters.map(e=>e.name).join("ã€")]})})]}),s.jsx("div",{className:"flex flex-col gap-2",children:e.isCreated?s.jsxs("button",{onClick:()=>T(e),className:"px-4 py-2 bg-green-500 text-white rounded-lg text-sm hover:bg-green-600 flex items-center gap-1",children:[s.jsx(n,{className:"w-4 h-4"}),"æ’­æ”¾"]}):s.jsxs("button",{onClick:()=>(e=>{U(e.id),D(!0)})(e),className:"px-4 py-2 bg-amber-500 text-white rounded-lg text-sm hover:bg-amber-600 flex items-center gap-1",children:[s.jsx(p,{className:"w-4 h-4"}),"åˆ›å»º"]})})]}),s.jsx("div",{className:"mt-3 p-2 bg-eco-50 rounded-lg",children:s.jsxs("p",{className:"text-xs text-eco-600 flex items-center gap-1",children:[s.jsx(b,{className:"w-3 h-3"}),e.ecoMessage]})})]},e.id))}),s.jsx("button",{onClick:()=>z("intro"),className:"w-full mt-4 py-3 text-amber-600 hover:text-amber-800 transition-colors",children:"è¿”å›"})]})})}),"perform"===S&&Q&&s.jsx("div",{ref:y,className:"absolute inset-0 pt-24 pb-36",children:s.jsx("div",{className:"relative w-full h-full",children:Q.characters.map(e=>{const a=B[e.id];return a?s.jsx(w,{character:e,x:a.x,y:a.y,isActive:L,onDrag:(s,a)=>((e,s,a)=>{J(t=>({...t,[e]:{x:s,y:a}}))})(e.id,s,a)},e.id):null})})}),"perform"===S&&Q&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-30",children:s.jsx("div",{className:"bg-gradient-to-t from-amber-950/95 to-transparent pt-12 pb-6 px-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 text-amber-200 text-sm",children:[s.jsx("span",{children:"è¡¨æ¼”è¿›åº¦"}),s.jsxs("span",{children:[Math.round(P),"%"]})]}),s.jsx("div",{className:"h-2 bg-amber-800/50 rounded-full overflow-hidden mb-4",children:s.jsx(m.div,{className:"h-full bg-gradient-to-r from-amber-400 to-amber-500",style:{width:`${P}%`}})}),s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{onClick:()=>{z("select"),A(!1),R(0)},className:"p-3 bg-amber-800/50 hover:bg-amber-800 rounded-full text-amber-200",children:s.jsx(i,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>A(!L),className:"p-4 bg-amber-500 hover:bg-amber-600 rounded-full text-white",children:L?s.jsx(j,{className:"w-6 h-6"}):s.jsx(n,{className:"w-6 h-6"})}),s.jsx("button",{onClick:()=>{},className:"p-3 bg-amber-800/50 hover:bg-amber-800 rounded-full text-amber-200",children:s.jsx(f,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"text-center mt-3",children:[s.jsx("p",{className:"text-amber-100 font-bold",children:Q.title}),s.jsx("p",{className:"text-amber-300 text-sm",children:Q.description})]})]})})}),s.jsx(o,{children:$&&Q&&s.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60",children:s.jsxs(m.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-gradient-to-b from-amber-100 to-amber-50 rounded-3xl p-8 max-w-md mx-4 shadow-2xl text-center",children:[s.jsx(x,{className:"w-16 h-16 text-amber-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-2xl font-bold text-amber-900 mb-2",children:"ğŸ­ ç²¾å½©è¡¨æ¼”ï¼"}),s.jsxs("p",{className:"text-amber-600 mb-6",children:[Q.title," Â· å®Œç¾è½å¹•"]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[s.jsxs("div",{className:"bg-eco-100 rounded-xl p-3",children:[s.jsx("div",{className:"text-eco-600 font-bold text-lg",children:"+80"}),s.jsx("div",{className:"text-eco-500 text-xs",children:"ç»¿è‰²ç§¯åˆ†"})]}),s.jsxs("div",{className:"bg-eco-100 rounded-xl p-3",children:[s.jsx("div",{className:"text-eco-600 font-bold text-lg",children:"350g"}),s.jsx("div",{className:"text-eco-500 text-xs",children:"ç¢³å‡æ’"})]}),s.jsxs("div",{className:"bg-eco-100 rounded-xl p-3",children:[s.jsx("div",{className:"text-eco-600 font-bold text-lg",children:"1"}),s.jsx("div",{className:"text-eco-500 text-xs",children:"å‰§ç›®å®Œæˆ"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{H(!1),z("select"),R(0)},className:"flex-1 py-3 bg-amber-200 text-amber-800 rounded-xl hover:bg-amber-300",children:"æ¢ä¸ªå‰§ç›®"}),s.jsx("button",{onClick:()=>a("/"),className:"flex-1 py-3 bg-amber-500 text-white rounded-xl hover:bg-amber-600",children:"è¿”å›é¦–é¡µ"})]})]})})}),_&&s.jsx(e.Suspense,{fallback:s.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"åŠ è½½ä¸­..."})}),children:s.jsx(N,{onClose:()=>{D(!1),U(null)},preSelectedPlayId:I||void 0,onComplete:e=>{E(s=>s.map(s=>s.id===I?{...s,characters:e.characters,isCreated:!0}:s)),D(!1);const s={...M.find(e=>e.id===I),characters:e.characters,isCreated:!0};T(s)}})})]})}export{y as default};
