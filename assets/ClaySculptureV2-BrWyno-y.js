import{r as e,j as s,C as a,F as t,T as r,O as n,E as l,u as i}from"./three-vendor-BoyHWg1a.js";import{d as o,u as c,a as d}from"./index-D20SIRsj.js";import{a as m}from"./core-vendor-Csnc5NqJ.js";import{X as x,R as h,A as b,m as j,L as p,e as u,aD as g,g as f,T as N,s as y,o as v}from"./ui-vendor-BCOa7pYq.js";const w=[{name:"ç¦è™",icon:"ğŸ¯",meaning:"è™è™ç”Ÿå¨ï¼Œé•‡å®…è¾Ÿé‚ª"},{name:"ç¥¥é©¬",icon:"ğŸ´",meaning:"é¾™é©¬ç²¾ç¥ï¼Œé©¬åˆ°æˆåŠŸ"},{name:"é‡‘é¸¡",icon:"ğŸ”",meaning:"é‡‘é¸¡æŠ¥æ™“ï¼Œå‰ç¥¥å¦‚æ„"},{name:"å¯ŒçŒª",icon:"ğŸ·",meaning:"é‡‘çŒªçº³ç¦ï¼Œå¯Œè´µæ»¡å ‚"},{name:"ç‘é±¼",icon:"ğŸŸ",meaning:"å¹´å¹´æœ‰ä½™ï¼Œæ‹›è´¢è¿›å®"},{name:"å‰ç¾Š",icon:"ğŸ‘",meaning:"ä¸‰é˜³å¼€æ³°ï¼Œå‰ç¥¥ç¾å¥½"}],S=["èŠ±å‰çº¹","äº‘çº¹","å¦‚æ„çº¹","è²èŠ±çº¹","ç‰¡ä¸¹çº¹","å‡¤å‡°çº¹"],C=["#DC2626","#FACC15","#22C55E","#3B82F6","#FB7185","#8B5CF6"],F=["#000000","#FFFFFF","#FFD700","#FF6B6B","#4ECDC4"],P=["ç¦æ°”ä¸´é—¨","äº”ç¦ä¸´é—¨","å‰ç¥¥å¦‚æ„","èŠ±å¼€å¯Œè´µ","é¾™å‡¤å‘ˆç¥¥","ç™¾äº‹å¦‚æ„"];function k(){const e=Math.floor(1e6*Math.random());return{seed:e,baseShape:w[e%w.length],bodyScale:{x:.8+e%40/100,y:.9+e%30/100,z:.85+e%35/100},headScale:.9+e%25/100,earScale:.7+e%50/100,decorStyle:S[(e>>3)%S.length],primaryColor:C[(e>>2)%C.length],secondaryColor:F[(e>>4)%F.length],blessing:P[(e>>5)%P.length],ecoScore:90+e%10}}function M({shape:a,sculptProgress:t,paintedParts:r,currentColor:n}){const l=e.useRef(null),[o,c]=e.useState(null);i(e=>{l.current&&(l.current.rotation.y=.2*e.clock.elapsedTime)});const d=e=>r.get(e)||"#E8D4B8";return s.jsxs("group",{ref:l,position:[0,.5,0],children:[t>0&&("ğŸ¯"===a.baseShape.icon?s.jsxs(s.Fragment,{children:[s.jsxs("mesh",{position:[0,0,0],scale:[a.bodyScale.x,a.bodyScale.y,a.bodyScale.z],onPointerOver:()=>c("body"),onPointerOut:()=>c(null),children:[s.jsx("sphereGeometry",{args:[.6,32,32]}),s.jsx("meshStandardMaterial",{color:d("body"),roughness:.8,emissive:"body"===o?n:"#000000",emissiveIntensity:"body"===o?.3:0})]}),s.jsxs("mesh",{position:[0,.7*a.headScale,0],scale:a.headScale,onPointerOver:()=>c("head"),onPointerOut:()=>c(null),children:[s.jsx("sphereGeometry",{args:[.45,32,32]}),s.jsx("meshStandardMaterial",{color:d("head"),roughness:.8,emissive:"head"===o?n:"#000000",emissiveIntensity:"head"===o?.3:0})]}),[-.25,.25].map((e,t)=>s.jsxs("mesh",{position:[e*a.earScale,1.1,0],scale:.5*a.earScale,onPointerOver:()=>c(`ear${t}`),onPointerOut:()=>c(null),children:[s.jsx("coneGeometry",{args:[.2,.3,8]}),s.jsx("meshStandardMaterial",{color:d(`ear${t}`),roughness:.8,emissive:o===`ear${t}`?n:"#000000",emissiveIntensity:o===`ear${t}`?.3:0})]},t)),[-.15,.15].map((e,a)=>s.jsxs("mesh",{position:[e,.75,.35],children:[s.jsx("sphereGeometry",{args:[.08,16,16]}),s.jsx("meshStandardMaterial",{color:d("eyes")})]},`eye${a}`)),s.jsxs("mesh",{position:[0,.9,.38],children:[s.jsx("boxGeometry",{args:[.15,.08,.02]}),s.jsx("meshStandardMaterial",{color:d("pattern")})]}),s.jsxs("mesh",{position:[0,0,-.7],rotation:[.5,0,0],onPointerOver:()=>c("tail"),onPointerOut:()=>c(null),children:[s.jsx("cylinderGeometry",{args:[.08,.05,.5,8]}),s.jsx("meshStandardMaterial",{color:d("tail"),roughness:.8,emissive:"tail"===o?n:"#000000",emissiveIntensity:"tail"===o?.3:0})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("mesh",{position:[0,0,0],scale:[a.bodyScale.x,a.bodyScale.y,a.bodyScale.z],children:[s.jsx("sphereGeometry",{args:[.6,32,32]}),s.jsx("meshStandardMaterial",{color:d("body"),roughness:.8})]}),s.jsxs("mesh",{position:[0,.8,0],scale:a.headScale,children:[s.jsx("sphereGeometry",{args:[.4,32,32]}),s.jsx("meshStandardMaterial",{color:d("head"),roughness:.8})]})]})),s.jsxs("mesh",{position:[0,-.8,0],receiveShadow:!0,children:[s.jsx("cylinderGeometry",{args:[.8,1,.2,32]}),s.jsx("meshStandardMaterial",{color:"#8B4513",roughness:.9})]})]})}function z({shape:e,sculptProgress:a,paintedParts:i,currentColor:o}){return s.jsxs(s.Fragment,{children:[s.jsx("ambientLight",{intensity:.5}),s.jsx("directionalLight",{position:[5,10,5],intensity:1,castShadow:!0}),s.jsx("pointLight",{position:[-5,5,-5],intensity:.5,color:"#FFE4B5"}),s.jsx("spotLight",{position:[0,5,0],intensity:.8,angle:.5,penumbra:.5}),s.jsx(M,{shape:e,sculptProgress:a,paintedParts:i,currentColor:o}),s.jsx(t,{speed:2,floatIntensity:.5,children:s.jsx(r,{position:[0,2.2,0],fontSize:.25,color:"#8B4513",anchorX:"center",children:e.blessing})}),s.jsx(n,{enablePan:!1,minDistance:2,maxDistance:6,minPolarAngle:Math.PI/6,maxPolarAngle:Math.PI/2}),s.jsx(l,{preset:"studio"})]})}const B=[{name:"æœ±çº¢",color:"#DC2626",desc:"å–œåº†å‰ç¥¥"},{name:"æ˜é»„",color:"#FACC15",desc:"å¯Œè´µè£å"},{name:"ç¿ ç»¿",color:"#22C55E",desc:"ç”Ÿæœºç›ç„¶"},{name:"å®è“",color:"#3B82F6",desc:"ç¥¥ç‘å¹³å®‰"},{name:"æ¡ƒç²‰",color:"#FB7185",desc:"å¨‡è‰³å¯çˆ±"},{name:"å¢¨é»‘",color:"#1C1917",desc:"å‹¾å‹’è½®å»“"},{name:"çº¯ç™½",color:"#FFFFFF",desc:"ç‚¹ç¼€é«˜å…‰"}];function I(){const t=m(),{unlockScene:r}=o(),{addPoints:n}=c(),{addCarbonSaving:l}=d(),[i,w]=e.useState(()=>k()),[S,C]=e.useState("intro"),[F,P]=e.useState(0),[M,I]=e.useState(new Map),[G,O]=e.useState(B[0].color),[D,E]=e.useState(!1);e.useEffect(()=>{if("sculpt"===S&&F<100){const e=setInterval(()=>{P(s=>s>=100?(clearInterval(e),C("paint"),100):s+2)},80);return()=>clearInterval(e)}},[S,F]),e.useEffect(()=>{"paint"===S&&M.size>=5&&(C("complete"),E(!0),n({type:"experience",points:80,description:"å®Œæˆæ³¥å¡‘å½©ç»˜ä½“éªŒ"}),l({type:"digital_experience",carbonSaved:600,description:"å¤©ç„¶é»„åœŸææ–™ä½“éªŒ",experienceId:"clay_sculpture_v2"}))},[S,M,n,l]),e.useCallback(e=>{"paint"===S&&I(s=>new Map(s).set(e,G))},[S,G]);return s.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-amber-100 via-amber-50 to-orange-50",children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 z-20 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>t(-1),className:"p-2 bg-white/80 backdrop-blur rounded-full shadow-lg",children:s.jsx(x,{className:"w-5 h-5 text-amber-700"})}),s.jsxs("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur rounded-full px-4 py-2 shadow-lg",children:[s.jsx("span",{className:"text-2xl",children:i.baseShape.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-amber-800",children:i.baseShape.name}),s.jsxs("div",{className:"text-xs text-amber-600",children:["#",i.seed.toString(16).toUpperCase()]})]})]}),s.jsx("button",{onClick:()=>{w(k())},className:"p-2 bg-white/80 backdrop-blur rounded-full shadow-lg",children:s.jsx(h,{className:"w-5 h-5 text-amber-700"})})]})}),s.jsx(b,{children:"intro"===S&&s.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 flex items-center justify-center bg-gradient-to-b from-amber-900/90 to-amber-800/90 p-4",children:s.jsxs(j.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-white rounded-3xl p-8 max-w-md w-full shadow-2xl text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-4xl",children:i.baseShape.icon})}),s.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-2",children:"ğŸº ä½ çš„ä¸“å±æ³¥å¡‘é€ å‹"}),s.jsx("p",{className:"text-amber-600 mb-4",children:i.blessing}),s.jsxs("div",{className:"bg-amber-50 rounded-2xl p-4 mb-6 text-left space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-amber-600",children:"é€ å‹"}),s.jsx("span",{className:"font-bold text-amber-800",children:i.baseShape.name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-amber-600",children:"å¯“æ„"}),s.jsx("span",{className:"font-bold text-amber-800 text-sm",children:i.baseShape.meaning})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-amber-600",children:"è£…é¥°çº¹æ ·"}),s.jsx("span",{className:"font-bold text-amber-800",children:i.decorStyle})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-amber-600",children:"ä¸»è‰²è°ƒ"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:i.primaryColor}}),s.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:i.secondaryColor}})]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-amber-600",children:"ç”Ÿæ€è¯„åˆ†"}),s.jsxs("span",{className:"font-bold text-eco-600",children:[i.ecoScore,"åˆ†"]})]})]}),s.jsxs("div",{className:"bg-eco-50 rounded-xl p-3 mb-6 flex items-center gap-3",children:[s.jsx(p,{className:"w-8 h-8 text-eco-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-sm font-bold text-eco-700",children:"å¤©ç„¶é»„åœŸ Â· 100%å¯é™è§£"}),s.jsx("p",{className:"text-xs text-eco-600",children:"ä¼ ç»Ÿå‡¤ç¿”æ³¥å¡‘ä½¿ç”¨å¤©ç„¶ææ–™"})]})]}),s.jsxs("button",{onClick:()=>{C("sculpt")},className:"w-full py-4 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all",children:[s.jsx(u,{className:"w-5 h-5 inline mr-2"}),"å¼€å§‹æå¡‘"]})]})})}),"intro"!==S&&s.jsx("div",{className:"absolute inset-0 pt-16 pb-44",children:s.jsx(a,{shadows:!0,camera:{position:[0,1,4],fov:50},children:s.jsx(e.Suspense,{fallback:null,children:s.jsx(z,{shape:i,sculptProgress:F,paintedParts:M,currentColor:G})})})}),"paint"===S&&s.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 z-20",children:s.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl p-3 space-y-2 shadow-lg",children:[s.jsxs("div",{className:"text-center text-amber-700 text-xs mb-2",children:[s.jsx(g,{className:"w-4 h-4 mx-auto mb-1"}),"é¢œæ–™"]}),B.map(e=>s.jsx("button",{onClick:()=>O(e.color),className:"w-10 h-10 rounded-full transition-all border-2 "+(G===e.color?"border-amber-500 scale-110":"border-transparent"),style:{backgroundColor:e.color},title:e.name},e.color))]})}),"intro"!==S&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-20 p-4",children:s.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl p-4 shadow-lg",children:["sculpt"===S&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-amber-700 font-medium",children:"æå¡‘è¿›åº¦"}),s.jsxs("span",{className:"text-amber-800 font-bold",children:[F,"%"]})]}),s.jsx("div",{className:"h-3 bg-amber-100 rounded-full overflow-hidden",children:s.jsx(j.div,{className:"h-full bg-gradient-to-r from-amber-400 to-orange-500",initial:{width:0},animate:{width:`${F}%`}})}),s.jsxs("p",{className:"text-xs text-amber-600 mt-2 text-center",children:["ğŸ¤² æ­£åœ¨å¡‘å½¢ä¸­... ",i.baseShape.name]})]}),"paint"===S&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-amber-700 font-medium",children:"å½©ç»˜è¿›åº¦"}),s.jsxs("span",{className:"text-amber-800 font-bold",children:[M.size,"/5"]})]}),s.jsx("div",{className:"h-3 bg-amber-100 rounded-full overflow-hidden",children:s.jsx(j.div,{className:"h-full bg-gradient-to-r from-red-400 to-yellow-500",initial:{width:0},animate:{width:M.size/5*100+"%"}})}),s.jsxs("p",{className:"text-xs text-amber-600 mt-2 text-center",children:["ğŸ¨ ç‚¹å‡»æ¨¡å‹éƒ¨ä½è¿›è¡Œä¸Šè‰² Â· ",i.decorStyle]})]})]})}),s.jsx(b,{children:D&&s.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:s.jsx(j.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-white rounded-3xl p-6 max-w-md w-full shadow-2xl",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(f,{className:"w-10 h-10 text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-amber-800 mb-2",children:"ğŸº æ³¥å¡‘å®Œæˆï¼"}),s.jsxs("p",{className:"text-amber-600 mb-4",children:[i.baseShape.name," Â· ",i.blessing]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[s.jsxs("div",{className:"bg-amber-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-2xl font-bold text-amber-600",children:"+80"}),s.jsx("div",{className:"text-xs text-amber-500",children:"ç»¿è‰²ç§¯åˆ†"})]}),s.jsxs("div",{className:"bg-eco-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-2xl font-bold text-eco-600",children:"600g"}),s.jsx("div",{className:"text-xs text-eco-500",children:"ç¢³å‡æ’"})]}),s.jsxs("div",{className:"bg-orange-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.ecoScore}),s.jsx("div",{className:"text-xs text-orange-500",children:"ç”Ÿæ€è¯„åˆ†"})]})]}),s.jsxs("div",{className:"bg-eco-50 rounded-xl p-4 mb-6 text-left",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(N,{className:"w-5 h-5 text-eco-600"}),s.jsx("span",{className:"font-bold text-eco-700",children:"å¤©ç„¶ææ–™ç”Ÿæ€æ™ºæ…§"})]}),s.jsx("p",{className:"text-sm text-eco-600",children:"å‡¤ç¿”æ³¥å¡‘ä½¿ç”¨å¤©ç„¶é»„åœŸã€æ£‰èŠ±å’Œç³¯ç±³æ±åˆ¶ä½œï¼Œ100%å¯ç”Ÿç‰©é™è§£ï¼Œ æ¯”å¡‘æ–™ç©å…·å‡å°‘80%ç¢³æ’æ”¾ï¼"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>{C("intro"),P(0),I(new Map),E(!1),w(k())},className:"flex-1 py-3 border-2 border-amber-500 text-amber-600 rounded-xl font-medium flex items-center justify-center gap-2",children:[s.jsx(y,{className:"w-4 h-4"}),"å†æ¥ä¸€æ¬¡"]}),s.jsxs("button",{onClick:()=>{r("clay_studio"),t("/create/polaroid?scene=clay_studio&design="+i.seed)},className:"flex-1 py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl font-medium flex items-center justify-center gap-2",children:[s.jsx(v,{className:"w-4 h-4"}),"ç”Ÿæˆæ‹ç«‹å¾—"]})]})]})})})})]})}export{I as default};
